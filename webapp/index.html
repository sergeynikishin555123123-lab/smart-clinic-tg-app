<!DOCTYPE html>
<html lang="ru" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>–ê–∫–∞–¥–µ–º–∏—è –ê–ù–ë - –°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—Ä–∞—á–µ–π</title>
    <meta name="description" content="–ê–∫–∞–¥–µ–º–∏—è –ê–ù–ë - –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è">
    
    <!-- Telegram WebApp -->
    <script>
        if (!window.Telegram) {
            window.Telegram = {
                WebApp: {
                    initData: '',
                    initDataUnsafe: {},
                    version: '6.0',
                    platform: 'web',
                    viewportHeight: window.innerHeight,
                    viewportStableHeight: window.innerHeight,
                    isExpanded: true,
                    themeParams: {
                        bg_color: '#172554',
                        text_color: '#ffffff',
                        hint_color: '#aaaaaa',
                        link_color: '#3b82f6',
                        button_color: '#3b82f6',
                        button_text_color: '#ffffff'
                    },
                    ready: function() { console.log('Telegram WebApp ready (fallback)'); },
                    expand: function() { console.log('Telegram WebApp expand (fallback)'); },
                    showPopup: function() { console.log('Telegram WebApp showPopup (fallback)'); },
                    BackButton: {
                        isVisible: false,
                        show: function() { this.isVisible = true; },
                        hide: function() { this.isVisible = false; },
                        onClick: function(callback) { this.callback = callback; }
                    }
                }
            };
            console.log('‚úÖ Telegram WebApp fallback loaded');
        }
    </script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-card: #1e293b;
            --text-primary: #ffffff;
            --text-secondary: #94a3b8;
            --accent: #3b82f6;
            --accent-hover: #2563eb;
            --border: #334155;
            --success: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;
            --info: #06b6d4;
            --light-bg: #f8fafc;
            --light-text: #1e293b;
            --light-secondary: #64748b;
        }
        
        [data-theme="light"] {
            --bg-primary: #f8fafc;
            --bg-secondary: #e2e8f0;
            --bg-card: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border: #cbd5e1;
        }
        
        body {
            margin: 0;
            padding: 0;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            overflow-x: hidden;
            min-height: 100vh;
            transition: background-color 0.3s, color 0.3s;
        }

        /* ==================== LOADING & ERROR STATES ==================== */
        
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: var(--bg-primary);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 9999;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top: 3px solid var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 16px;
        }
        
        .loading-text {
            color: var(--text-secondary);
            font-size: 16px;
        }
        
        .error-container {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: var(--bg-primary);
            text-align: center;
            padding: 20px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 9999;
        }
        
        #app {
            display: none;
            min-height: 100vh;
            background: var(--bg-primary);
        }

        /* ==================== LAYOUT STRUCTURE ==================== */
        
        .top-header {
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border);
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 999;
            backdrop-filter: blur(10px);
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .header-brand {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .brand-icon {
            font-size: 1.5rem;
        }

        .admin-badge {
            background: var(--warning);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            display: none;
        }

        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            padding-bottom: 80px;
        }

        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border);
            z-index: 1000;
            padding: 0.5rem 0;
        }

        .nav-scroll-container {
            display: flex;
            overflow-x: auto;
            gap: 0.5rem;
            padding: 0 1rem;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .nav-scroll-container::-webkit-scrollbar {
            display: none;
        }

        /* ==================== NAVIGATION BUTTONS ==================== */
        
        .bottom-nav .nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: none;
            border: none;
            color: var(--text-secondary);
            padding: 0.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 60px;
            position: relative;
            flex-shrink: 0;
        }

        .bottom-nav .nav-btn:hover,
        .bottom-nav .nav-btn.active {
            background: var(--accent);
            color: white;
        }

        .nav-icon {
            font-size: 1.25rem;
            margin-bottom: 0.25rem;
        }

        .nav-label {
            font-size: 0.7rem;
            white-space: nowrap;
        }

        .nav-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            background: var(--error);
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            font-size: 0.6rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ==================== HOME PAGE STYLES ==================== */
        
        .home-page {
            padding-bottom: 100px;
        }

        .hero-section {
            background: linear-gradient(135deg, var(--accent), #1e40af);
            border-radius: 1rem;
            padding: 2rem 1.5rem;
            margin-bottom: 2rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=800&h=400&fit=crop') center/cover;
            opacity: 0.1;
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .hero-content h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        .hero-subtitle {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .hero-search {
            display: flex;
            gap: 1rem;
            max-width: 500px;
            margin: 0 auto 2rem auto;
        }

        .search-input {
            flex: 1;
            padding: 1rem;
            border: none;
            border-radius: 0.75rem;
            background: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
            color: #1e293b;
        }

        .hero-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .stat {
            text-align: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 0.75rem;
            backdrop-filter: blur(10px);
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.875rem;
            opacity: 0.9;
        }

        /* ==================== MAIN NAVIGATION GRID ==================== */
        
        .main-navigation-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .nav-card-large {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 1rem;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            aspect-ratio: 1.6;
        }

        .nav-card-large:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .nav-card-image {
            position: relative;
            height: 100%;
            overflow: hidden;
        }

        .nav-card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .nav-card-large:hover .nav-card-image img {
            transform: scale(1.05);
        }

        .nav-card-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.9), rgba(30, 64, 175, 0.8));
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
            padding: 1.5rem;
        }

        .nav-card-icon {
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
        }

        .nav-card-overlay h3 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        .nav-card-overlay p {
            font-size: 0.875rem;
            opacity: 0.9;
        }

        .nav-count {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
            font-size: 0.75rem;
        }

        /* ==================== CONTENT SECTIONS ==================== */
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .quick-nav-section,
        .featured-section,
        .live-section,
        .events-section,
        .news-section,
        .learning-stats-section {
            margin-bottom: 3rem;
        }

        /* ==================== CONTENT GRID & CARDS ==================== */
        
        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .content-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            overflow: hidden;
            transition: all 0.3s;
            position: relative;
        }

        .content-card:hover {
            transform: translateY(-4px);
            border-color: var(--accent);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .card-image {
            position: relative;
            height: 200px;
            overflow: hidden;
        }

        .card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .content-card:hover .card-image img {
            transform: scale(1.05);
        }

        .card-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: flex-start;
            justify-content: flex-end;
            padding: 1rem;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .content-card:hover .card-overlay {
            opacity: 1;
        }

        .favorite-btn,
        .play-btn,
        .preview-btn,
        .download-btn {
            background: rgba(0, 0, 0, 0.7);
            border: none;
            color: white;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin-left: 0.5rem;
            transition: all 0.3s;
        }

        .favorite-btn.active {
            background: var(--error);
        }

        .favorite-btn:hover,
        .play-btn:hover,
        .preview-btn:hover,
        .download-btn:hover {
            transform: scale(1.1);
        }

        .card-content {
            padding: 1.5rem;
        }

        .card-category {
            color: var(--accent);
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .card-title {
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
            line-height: 1.4;
        }

        .card-description {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .card-meta {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .meta-item {
            color: var(--text-secondary);
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .price-section {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .price-original {
            color: var(--text-secondary);
            text-decoration: line-through;
            font-size: 0.875rem;
        }

        .price-current {
            font-weight: bold;
            color: var(--accent);
        }

        /* ==================== BUTTONS ==================== */
        
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-hover);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-primary);
        }

        .btn-outline:hover {
            background: var(--bg-secondary);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-small {
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
        }

        .btn-large {
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
        }

        /* ==================== BADGES ==================== */
        
        .featured-badge,
        .discount-badge,
        .live-badge,
        .progress-badge {
            position: absolute;
            top: 1rem;
            left: 1rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .featured-badge {
            background: var(--warning);
            color: white;
        }

        .discount-badge {
            background: var(--error);
            color: white;
        }

        .live-badge {
            background: var(--error);
            color: white;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .live-pulse {
            width: 6px;
            height: 6px;
            background: white;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .progress-badge {
            background: var(--success);
            color: white;
        }

        /* ==================== PROGRESS & STATS ==================== */
        
        .progress-section {
            margin: 1rem 0;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }

        .progress-bar {
            background: var(--bg-primary);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            background: var(--accent);
            height: 100%;
            transition: width 0.3s;
        }

        .progress-text {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .stat-card.large {
            grid-column: span 1;
        }

        .stat-icon {
            font-size: 2rem;
            background: var(--accent);
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .stat-content {
            flex: 1;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .stat-trend {
            color: var(--success);
            font-size: 0.75rem;
        }

        /* ==================== NEWS & EVENTS ==================== */
        
        .news-filters {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.875rem;
        }

        .filter-btn.active,
        .filter-btn:hover {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .events-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .events-timeline {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        /* ==================== MODALS ==================== */
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-card);
            border-radius: 1rem;
            max-width: 90vw;
            max-height: 90vh;
            width: 100%;
            overflow: hidden;
            position: relative;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: bold;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.25rem;
        }

        .modal-close:hover {
            background: var(--bg-secondary);
        }

        .modal-body {
            padding: 1.5rem;
            max-height: 70vh;
            overflow-y: auto;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        /* ==================== MEDIA PLAYER ==================== */
        
        .media-player {
            width: 100%;
            background: #000;
            border-radius: 0.5rem;
            overflow: hidden;
        }

        .media-player video,
        .media-player audio {
            width: 100%;
            display: block;
        }

        .audio-player {
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 0.5rem;
        }

        .audio-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .audio-cover {
            width: 80px;
            height: 80px;
            border-radius: 0.5rem;
            object-fit: cover;
        }

        .audio-details {
            flex: 1;
        }

        .audio-title {
            font-size: 1.125rem;
            margin-bottom: 0.25rem;
        }

        .audio-author {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .audio-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .audio-progress {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .progress-bar-container {
            background: var(--bg-primary);
            height: 4px;
            border-radius: 2px;
            overflow: hidden;
            cursor: pointer;
        }

        .progress-bar-fill {
            background: var(--accent);
            height: 100%;
            width: 0%;
            transition: width 0.1s;
        }

        .time-display {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .control-btn {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-btn:hover {
            background: var(--bg-secondary);
        }

        /* ==================== NOTIFICATIONS ==================== */
        
        .notification {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            padding: 1rem;
            max-width: 300px;
            z-index: 1002;
            animation: slideIn 0.3s ease-out;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .notification-content {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .notification-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            margin-left: auto;
            padding: 0.25rem;
            border-radius: 0.25rem;
        }

        .notification-close:hover {
            background: var(--bg-secondary);
        }

        /* ==================== EMPTY STATES ==================== */
        
        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--text-secondary);
        }

        .empty-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .empty-title {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .empty-description {
            font-size: 0.875rem;
            margin-bottom: 1.5rem;
        }

        .empty-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* ==================== FORMS ==================== */
        
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            background: var(--bg-card);
            color: var(--text-primary);
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--accent);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        /* ==================== ADMIN PANEL ==================== */
        
        .admin-panel {
            padding: 1rem;
        }

        .admin-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid var(--border);
            padding-bottom: 0.5rem;
        }

        .admin-tab {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 0.5rem 0.5rem 0 0;
            transition: all 0.3s;
        }

        .admin-tab.active {
            background: var(--accent);
            color: white;
        }

        .admin-content {
            background: var(--bg-card);
            border-radius: 0.75rem;
            padding: 1.5rem;
            border: 1px solid var(--border);
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .admin-stat {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: 0.75rem;
            text-align: center;
        }

        .admin-stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .admin-stat-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
        }

        .admin-table th,
        .admin-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .admin-table th {
            background: var(--bg-secondary);
            font-weight: 600;
        }

        .admin-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* ==================== ANIMATIONS ==================== */
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* ==================== RESPONSIVE DESIGN ==================== */
        
        @media (max-width: 768px) {
            .header-brand .brand-text {
                display: none;
            }
            
            .nav-label {
                font-size: 0.65rem;
            }
            
            .bottom-nav .nav-btn {
                min-width: 50px;
                padding: 0.4rem;
            }

            .hero-content h1 {
                font-size: 2rem;
            }

            .hero-subtitle {
                font-size: 1rem;
            }

            .hero-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .hero-search {
                flex-direction: column;
            }

            .main-navigation-grid {
                grid-template-columns: 1fr;
            }

            .content-grid {
                grid-template-columns: 1fr;
            }

            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .stats-cards {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .admin-tabs {
                flex-wrap: wrap;
            }

            .admin-table {
                display: block;
                overflow-x: auto;
            }
        }

        @media (max-width: 480px) {
            .main-content {
                padding: 0.5rem;
            }
            
            .hero-section {
                padding: 1.5rem 1rem;
                margin-bottom: 1.5rem;
            }

            .hero-content h1 {
                font-size: 1.75rem;
            }

            .nav-card-overlay {
                padding: 1rem;
            }

            .nav-card-overlay h3 {
                font-size: 1.1rem;
            }

            .nav-scroll-container {
                padding: 0 0.5rem;
            }
            
            .bottom-nav .nav-btn {
                min-width: 45px;
            }
            
            .nav-icon {
                font-size: 1.1rem;
            }
            
            .nav-label {
                font-size: 0.6rem;
            }

            .modal-content {
                max-width: 95vw;
                max-height: 95vh;
            }
        }

        /* ==================== FOOTER ==================== */
        
        .main-footer {
            background: var(--bg-secondary);
            border-top: 1px solid var(--border);
            margin-top: 3rem;
        }

        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .footer-section h3 {
            margin-bottom: 1rem;
        }

        .footer-links {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
        }

        .footer-links a:hover {
            color: var(--accent);
        }

        .footer-bottom {
            border-top: 1px solid var(--border);
            padding: 1rem;
            text-align: center;
            color: var(--text-secondary);
        }

        /* ==================== DETAIL PAGES ==================== */
        
        .detail-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .back-btn {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .back-btn:hover {
            background: var(--bg-secondary);
        }

        .detail-content {
            background: var(--bg-card);
            border-radius: 1rem;
            padding: 2rem;
            border: 1px solid var(--border);
            margin-bottom: 2rem;
        }

        .detail-image {
            width: 100%;
            height: 300px;
            object-fit: cover;
            border-radius: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .detail-meta {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .detail-meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .detail-description {
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .detail-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .module-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .module-item {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .module-item:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .module-icon {
            font-size: 1.5rem;
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            background: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .module-content {
            flex: 1;
        }

        .module-title {
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
        }

        .module-description {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .module-duration {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .instructor-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .instructor-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
        }

        .instructor-info {
            flex: 1;
        }

        .instructor-name {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .instructor-specialization {
            color: var(--accent);
            margin-bottom: 0.5rem;
        }

        .instructor-bio {
            color: var(--text-secondary);
            font-size: 0.875rem;
            line-height: 1.5;
        }

        /* ==================== CONTENT FILTERS ==================== */
        
        .content-filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-select {
            padding: 0.5rem;
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            background: var(--bg-card);
            color: var(--text-primary);
            min-width: 150px;
        }

        /* ==================== TABS ==================== */
        
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .tab-btn {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 0.5rem 0.5rem 0 0;
            transition: all 0.3s;
        }

        .tab-btn.active {
            background: var(--accent);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
    </style>
</head>
<body>
    <!-- –ó–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —ç–∫—Ä–∞–Ω -->
    <div id="loadingScreen" class="loading-container">
        <div class="loading-spinner"></div>
        <div class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞ –ê–∫–∞–¥–µ–º–∏–∏ –ê–ù–ë...</div>
    </div>
    
    <!-- –≠–∫—Ä–∞–Ω –æ—à–∏–±–∫–∏ -->
    <div id="errorScreen" class="error-container">
        <div class="error-icon">‚ö†Ô∏è</div>
        <div class="error-title">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>
        <div class="error-description" id="errorMessage">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</div>
        <button id="retryButton" class="btn btn-primary">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div id="app">
        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <div class="nav-scroll-container">
                <button class="nav-btn active" data-page="home">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-label">–ì–ª–∞–≤–Ω–∞—è</span>
                </button>
                <button class="nav-btn" data-page="courses">
                    <span class="nav-icon">üìö</span>
                    <span class="nav-label">–ö—É—Ä—Å—ã</span>
                </button>
                <button class="nav-btn" data-page="podcasts">
                    <span class="nav-icon">üéß</span>
                    <span class="nav-label">–ü–æ–¥–∫–∞—Å—Ç—ã</span>
                </button>
                <button class="nav-btn" data-page="streams">
                    <span class="nav-icon">üìπ</span>
                    <span class="nav-label">–≠—Ñ–∏—Ä—ã</span>
                </button>
                <button class="nav-btn" data-page="videos">
                    <span class="nav-icon">üéØ</span>
                    <span class="nav-label">–í–∏–¥–µ–æ</span>
                </button>
                <button class="nav-btn" data-page="materials">
                    <span class="nav-icon">üìã</span>
                    <span class="nav-label">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</span>
                </button>
                <button class="nav-btn" data-page="events">
                    <span class="nav-icon">üó∫Ô∏è</span>
                    <span class="nav-label">–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</span>
                </button>
                <button class="nav-btn" data-page="favorites">
                    <span class="nav-icon">‚ù§Ô∏è</span>
                    <span class="nav-label">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
                    <span class="nav-badge" id="favoritesCount">0</span>
                </button>
                <button class="nav-btn" data-page="profile">
                    <span class="nav-icon">üë§</span>
                    <span class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</span>
                </button>
            </div>
        </nav>

        <!-- Top Header -->
        <header class="top-header">
            <div class="header-container">
                <div class="header-brand">
                    <span class="brand-icon">üéì</span>
                    <span class="brand-text">–ê–∫–∞–¥–µ–º–∏—è –ê–ù–ë</span>
                </div>
                <div class="header-actions">
                    <div id="adminBadge" class="admin-badge">üîß –ê–¥–º–∏–Ω</div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main id="mainContent" class="main-content">
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
        </main>

        <!-- Footer -->
        <footer class="main-footer">
            <div class="footer-container">
                <div class="footer-section">
                    <h3>–ê–∫–∞–¥–µ–º–∏—è –ê–ù–ë</h3>
                    <p>–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—Ä–∞—á–µ–π</p>
                </div>
                <div class="footer-section">
                    <h3>–†–µ—Å—É—Ä—Å—ã</h3>
                    <div class="footer-links">
                        <a href="javascript:void(0)" onclick="app.renderPage('courses')">–í—Å–µ –∫—É—Ä—Å—ã</a>
                        <a href="javascript:void(0)" onclick="app.renderPage('materials')">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</a>
                        <a href="javascript:void(0)" onclick="app.renderPage('community')">–û —Å–æ–æ–±—â–µ—Å—Ç–≤–µ</a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>–ü–æ–º–æ—â—å</h3>
                    <div class="footer-links">
                        <a href="javascript:void(0)" onclick="app.showNotification('–î–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–∞–ø–∏—à–∏—Ç–µ @anb_support', 'info')">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</a>
                        <a href="javascript:void(0)" onclick="app.renderPage('community')">–ü—Ä–∞–≤–∏–ª–∞</a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 –ê–∫–∞–¥–µ–º–∏—è –ê–ù–ë. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            </div>
        </footer>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="mediaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="mediaModalTitle">–ú–µ–¥–∏–∞</div>
                <button class="modal-close" onclick="app.closeMediaModal()">√ó</button>
            </div>
            <div class="modal-body" id="mediaModalBody">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –º–µ–¥–∏–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —Å—é–¥–∞ -->
            </div>
        </div>
    </div>

    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">–í—ã–±–æ—Ä –ø–æ–¥–ø–∏—Å–∫–∏</div>
                <button class="modal-close" onclick="app.closeSubscriptionModal()">√ó</button>
            </div>
            <div class="modal-body" id="subscriptionModalBody">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∫–∏ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —Å—é–¥–∞ -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="app.closeSubscriptionModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="app.processSubscription()">–û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É</button>
            </div>
        </div>
    </div>

    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                <button class="modal-close" onclick="app.closeSettingsModal()">√ó</button>
            </div>
            <div class="modal-body" id="settingsModalBody">
                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Å—é–¥–∞ -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="app.closeSettingsModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="app.saveSettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        // –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        class AcademyApp {
            constructor() {
                console.log('üéì –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ AcademyApp...');
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
                this.currentPage = 'home';
                this.currentSubPage = '';
                this.isAdmin = false;
                this.isSuperAdmin = false;
                this.allContent = {};
                this.state = {
                    favorites: {
                        courses: [],
                        podcasts: [],
                        streams: [],
                        videos: [],
                        materials: [],
                        events: []
                    },
                    cart: [],
                    progress: {},
                    settings: {
                        notifications: true,
                        autoPlay: false,
                        theme: 'dark',
                        language: 'ru'
                    }
                };
                this.filters = {
                    courses: { category: 'all', level: 'all', sort: 'newest', search: '' },
                    podcasts: { category: 'all', sort: 'newest', search: '' },
                    streams: { category: 'all', sort: 'newest', search: '' },
                    videos: { category: 'all', sort: 'newest', search: '' },
                    materials: { category: 'all', material_type: 'all', sort: 'newest', search: '' },
                    events: { category: 'all', sort: 'newest', search: '' }
                };
                this.subscriptionState = {
                    selectedPlan: null,
                    selectedPeriod: 'monthly'
                };
                this.mediaPlayers = {
                    video: null,
                    audio: null
                };
                this.currentNewsFilter = '–í—Å–µ';
                this.navigationItems = [];
                this.subscriptionPlans = [];
                this.userSubscription = null;
                this.instructors = [];
                this.currentUser = null;
                this.searchTerm = '';
                this.notifications = [];
                this.currentAudioPlayer = null;
                this.currentVideoPlayer = null;
                
                // –ü—É—Ç—å –æ–±—É—á–µ–Ω–∏—è
                this.learningPath = {
                    '–ù–æ–≤–∏—á–æ–∫': { minExp: 0, maxExp: 500, description: '–ù–∞—á–∞–ª–æ –ø—É—Ç–∏ –≤ –ê–∫–∞–¥–µ–º–∏–∏', steps: ['–ü—Ä–æ–π–¥–∏—Ç–µ 1 –∫—É—Ä—Å', '–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ 5 –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤'] },
                    '–ü–æ–Ω–∏–º–∞—é': { minExp: 500, maxExp: 1500, description: '–û—Å–≤–æ–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –Ω–∞–≤—ã–∫–æ–≤', steps: ['–ü—Ä–æ–π–¥–∏—Ç–µ 3 –∫—É—Ä—Å–∞', '–ó–∞–≤–µ—Ä—à–∏—Ç–µ 2 –º–æ–¥—É–ª—è'] },
                    '–ü—Ä–∞–∫—Ç–∏–∫': { minExp: 1500, maxExp: 3000, description: '–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∑–Ω–∞–Ω–∏–π –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ', steps: ['–ü—Ä–æ–π–¥–∏—Ç–µ 5 –∫—É—Ä—Å–æ–≤', '–£—á–∞—Å—Ç–≤—É–π—Ç–µ –≤ —ç—Ñ–∏—Ä–∞—Ö'] },
                    '–≠–∫—Å–ø–µ—Ä—Ç': { minExp: 3000, maxExp: 5000, description: '–ì–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞', steps: ['–°—Ç–∞–Ω—å—Ç–µ –º–µ–Ω—Ç–æ—Ä–æ–º', '–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π –∫—É—Ä—Å'] }
                };
                
                // –ü—Ä–∞–≤–∏–ª–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
                this.communityRules = [
                    { title: '–£–≤–∞–∂–µ–Ω–∏–µ', description: '–£–≤–∞–∂–∞–π—Ç–µ –º–Ω–µ–Ω–∏–µ –¥—Ä—É–≥–∏—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤' },
                    { title: '–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å', description: '–ù–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–π—Ç–µ –ª–∏—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é' },
                    { title: '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–∏–∑–º', description: '–°–æ–±–ª—é–¥–∞–π—Ç–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é —ç—Ç–∏–∫—É' },
                    { title: '–í–∑–∞–∏–º–æ–ø–æ–º–æ—â—å', description: '–ü–æ–º–æ–≥–∞–π—Ç–µ –¥—Ä—É–≥–∏–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º' }
                ];
                
                // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
                this.config = {
                    API_BASE_URL: window.location.origin,
                    UPLOAD_LIMIT: 50 * 1024 * 1024 // 50MB
                };

                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
                this.initializeData();
            }

            // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –î–ê–ù–ù–´–• ====================

            initializeData() {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö
                this.createDemoUser();
                this.createDemoContent();
                this.loadSubscriptionData();
                this.loadInstructors();
                this.loadNavigation();
                this.loadUserProgress();
            }

            // ==================== –û–°–ù–û–í–ù–´–ï –ú–ï–¢–û–î–´ ====================

            async init() {
                console.log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ê–∫–∞–¥–µ–º–∏–∏ –ê–ù–ë...');
                
                try {
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
                    if (window.Telegram && Telegram.WebApp) {
                        Telegram.WebApp.ready();
                        Telegram.WebApp.expand();
                        Telegram.WebApp.enableClosingConfirmation();
                        console.log('‚úÖ Telegram WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                    }
                    
                    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
                    this.restoreState();
                    
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                    this.setupEventListeners();
                    this.renderPage('home');
                    this.updateAllCounters();
                    
                    console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
                    
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                    this.showFatalError('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
                }
            }

            // ==================== –°–ò–°–¢–ï–ú–ê –°–û–•–†–ê–ù–ï–ù–ò–Ø –°–û–°–¢–û–Ø–ù–ò–Ø ====================

            saveState() {
                const state = {
                    favorites: this.state.favorites,
                    cart: this.state.cart,
                    progress: this.state.progress,
                    settings: this.state.settings,
                    filters: this.filters,
                    currentPage: this.currentPage
                };
                localStorage.setItem('academyAppState', JSON.stringify(state));
            }

            restoreState() {
                try {
                    const saved = localStorage.getItem('academyAppState');
                    if (saved) {
                        const state = JSON.parse(saved);
                        this.state.favorites = state.favorites || this.state.favorites;
                        this.state.cart = state.cart || this.state.cart;
                        this.state.progress = state.progress || this.state.progress;
                        this.state.settings = state.settings || this.state.settings;
                        this.filters = state.filters || this.filters;
                        this.currentPage = state.currentPage || 'home';
                        
                        // –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                        this.applySettings();
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è:', error);
                }
            }

            applySettings() {
                // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã
                document.documentElement.setAttribute('data-theme', this.state.settings.theme);
                
                // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —è–∑—ã–∫–∞
                document.documentElement.lang = this.state.settings.language;
            }

            // ==================== –°–ò–°–¢–ï–ú–ê –†–ï–ù–î–ï–†–ò–ù–ì–ê ====================

            renderPage(page, subPage = '') {
                console.log(`üîÑ –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å—Ç—Ä–∞–Ω–∏—Ü—ã: ${page}${subPage ? ` (${subPage})` : ''}`);
                
                this.currentPage = page;
                this.currentSubPage = subPage;
                
                const appElement = document.getElementById('mainContent');
                if (!appElement) {
                    console.error('‚ùå –≠–ª–µ–º–µ–Ω—Ç #mainContent –Ω–µ –Ω–∞–π–¥–µ–Ω');
                    return;
                }

                try {
                    let pageContent = '';
                    
                    if (subPage) {
                        pageContent = this.renderSubPage(subPage);
                    } else {
                        const pageMethods = {
                            'home': () => this.createHomePage(),
                            'courses': () => this.createCoursesPage(),
                            'podcasts': () => this.createPodcastsPage(),
                            'videos': () => this.createVideosPage(),
                            'materials': () => this.createMaterialsPage(),
                            'streams': () => this.createStreamsPage(),
                            'events': () => this.createEventsPage(),
                            'favorites': () => this.createFavoritesPage(),
                            'profile': () => this.createProfilePage(),
                            'community': () => this.createCommunityPage(),
                            'cart': () => this.createCartPage(),
                            'search': () => this.createSearchPage(),
                            'settings': () => this.createSettingsPage(),
                            'admin': () => this.createAdminPage()
                        };

                        pageContent = pageMethods[page] ? pageMethods[page]() : this.createNotFoundPage();
                    }
                    
                    appElement.innerHTML = pageContent;
                    this.initializePageComponents();
                    this.updateActiveNav();
                    this.saveState();
                    
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:', error);
                    appElement.innerHTML = this.createErrorPage('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã');
                }
            }

            renderSubPage(subPage) {
                const subPageHandlers = {
                    'course': (id) => this.createCourseDetailPage(id),
                    'stream': (id) => this.createStreamDetailPage(id),
                    'instructor': (id) => this.createInstructorDetailPage(id),
                    'podcast': (id) => this.createPodcastDetailPage(id),
                    'video': (id) => this.createVideoDetailPage(id),
                    'material': (id) => this.createMaterialDetailPage(id),
                    'event': (id) => this.createEventDetailPage(id)
                };

                for (const [type, handler] of Object.entries(subPageHandlers)) {
                    if (subPage.startsWith(`${type}-`)) {
                        const id = parseInt(subPage.replace(`${type}-`, ''));
                        return handler(id);
                    }
                }

                return this.createNotFoundPage();
            }

            // ==================== –ì–õ–ê–í–ù–ê–Ø –°–¢–†–ê–ù–ò–¶–ê ====================

            createHomePage() {
                const stats = this.calculateHomeStats();
                const recommendedCourses = this.getRecommendedCourses();
                const liveStreams = this.getLiveStreams();
                const upcomingEvents = this.getUpcomingEvents();
                const newsItems = this.createNewsItems();
                
                return `
                    <div class="page home-page">
                        <!-- Hero Section -->
                        <div class="hero-section">
                            <div class="hero-content">
                                <h1>–ê–∫–∞–¥–µ–º–∏—è –ê–ù–ë</h1>
                                <p class="hero-subtitle">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –Ω–µ–≤—Ä–æ–ª–æ–≥–æ–≤ –∏ —Ä–µ–∞–±–∏–ª–∏—Ç–æ–ª–æ–≥–æ–≤</p>
                                <div class="hero-search">
                                    <input type="text" 
                                           class="search-input" 
                                           placeholder="–ü–æ–∏—Å–∫ –∫—É—Ä—Å–æ–≤, –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤, –≤–∏–¥–µ–æ..."
                                           value="${this.searchTerm}"
                                           oninput="app.handleSearchInput(this.value)"
                                           onkeypress="app.handleSearchKeypress(event)">
                                    <button class="btn btn-primary" onclick="app.performSearch()">
                                        üîç –ü–æ–∏—Å–∫
                                    </button>
                                </div>
                                <div class="hero-stats">
                                    <div class="stat">
                                        <div class="stat-number">${stats.courses}</div>
                                        <div class="stat-label">–ö—É—Ä—Å–æ–≤</div>
                                    </div>
                                    <div class="stat">
                                        <div class="stat-number">${stats.students}</div>
                                        <div class="stat-label">–°—Ç—É–¥–µ–Ω—Ç–æ–≤</div>
                                    </div>
                                    <div class="stat">
                                        <div class="stat-number">${stats.experts}</div>
                                        <div class="stat-label">–≠–∫—Å–ø–µ—Ä—Ç–æ–≤</div>
                                    </div>
                                    <div class="stat">
                                        <div class="stat-number">${stats.materials}</div>
                                        <div class="stat-label">–ú–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- –ë—ã—Å—Ç—Ä–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è 2x2 -->
                        <div class="quick-nav-section">
                            <h2 class="section-title">üìö –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø</h2>
                            <div class="main-navigation-grid">
                                ${this.navigationItems.map(item => `
                                    <div class="nav-card-large" onclick="app.renderPage('${item.page}')">
                                        <div class="nav-card-image">
                                            <img src="${item.image_url}" alt="${item.title}" 
                                                 onerror="this.src='https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=400&h=250&fit=crop'">
                                            <div class="nav-card-overlay">
                                                <div class="nav-card-icon">${item.icon}</div>
                                                <h3>${item.title}</h3>
                                                <p>${item.description}</p>
                                            </div>
                                            <div class="nav-count">${this.getContentCount(item.page)}</div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <!-- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫—É—Ä—Å—ã -->
                        ${recommendedCourses.length > 0 ? `
                        <div class="featured-section">
                            <div class="section-header">
                                <h2 class="section-title">‚≠ê –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫—É—Ä—Å—ã</h2>
                                <button class="btn btn-outline" onclick="app.renderPage('courses')">
                                    –í—Å–µ –∫—É—Ä—Å—ã ‚Üí
                                </button>
                            </div>
                            <div class="content-grid">
                                ${recommendedCourses.slice(0, 4).map(course => this.createCourseCard(course)).join('')}
                            </div>
                        </div>
                        ` : ''}

                        <!-- LIVE —ç—Ñ–∏—Ä—ã -->
                        ${liveStreams.length > 0 ? `
                        <div class="live-section">
                            <div class="section-header">
                                <h2 class="section-title">üî¥ –ü—Ä—è–º—ã–µ —ç—Ñ–∏—Ä—ã</h2>
                                <div class="live-indicator">
                                    <div class="live-pulse"></div>
                                    ONLINE
                                </div>
                            </div>
                            <div class="content-grid">
                                ${liveStreams.slice(0, 2).map(stream => this.createStreamCard(stream)).join('')}
                            </div>
                        </div>
                        ` : ''}

                        <!-- –ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è -->
                        ${upcomingEvents.length > 0 ? `
                        <div class="events-section">
                            <div class="section-header">
                                <h2 class="section-title">üóìÔ∏è –ë–ª–∏–∂–∞–π—à–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</h2>
                                <button class="btn btn-outline" onclick="app.renderPage('events')">
                                    –í—Å–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è ‚Üí
                                </button>
                            </div>
                            <div class="events-list">
                                ${upcomingEvents.slice(0, 3).map(event => this.createEventCard(event)).join('')}
                            </div>
                        </div>
                        ` : ''}

                        <!-- –ù–æ–≤–æ—Å—Ç–∏ -->
                        <div class="news-section">
                            <div class="section-header">
                                <h2 class="section-title">üì∞ –ù–æ–≤–æ—Å—Ç–∏ –ê–∫–∞–¥–µ–º–∏–∏</h2>
                                <div class="news-filters">
                                    <button class="filter-btn ${this.currentNewsFilter === '–í—Å–µ' ? 'active' : ''}" 
                                            onclick="app.filterNews('–í—Å–µ')">–í—Å–µ</button>
                                    <button class="filter-btn ${this.currentNewsFilter === '–ù–µ–≤—Ä–æ–ª–æ–≥–∏—è' ? 'active' : ''}" 
                                            onclick="app.filterNews('–ù–µ–≤—Ä–æ–ª–æ–≥–∏—è')">–ù–µ–≤—Ä–æ–ª–æ–≥–∏—è</button>
                                    <button class="filter-btn ${this.currentNewsFilter === '–†–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏—è' ? 'active' : ''}" 
                                            onclick="app.filterNews('–†–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏—è')">–†–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏—è</button>
                                    <button class="filter-btn ${this.currentNewsFilter === '–û–±–Ω–æ–≤–ª–µ–Ω–∏—è' ? 'active' : ''}" 
                                            onclick="app.filterNews('–û–±–Ω–æ–≤–ª–µ–Ω–∏—è')">–û–±–Ω–æ–≤–ª–µ–Ω–∏—è</button>
                                </div>
                            </div>
                            <div class="news-grid">
                                ${newsItems}
                            </div>
                        </div>

                        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è -->
                        <div class="learning-stats-section">
                            <h2 class="section-title">üìä –í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å</h2>
                            <div class="stats-cards">
                                <div class="stat-card large">
                                    <div class="stat-icon">üéØ</div>
                                    <div class="stat-content">
                                        <div class="stat-value">${this.state.progress.completedCourses || 0}</div>
                                        <div class="stat-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ –∫—É—Ä—Å–æ–≤</div>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: ${((this.state.progress.completedCourses || 0) / Math.max(this.allContent.courses?.length || 1, 1)) * 100}%"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-card large">
                                    <div class="stat-icon">‚è±Ô∏è</div>
                                    <div class="stat-content">
                                        <div class="stat-value">${this.state.progress.studyHours || 0}</div>
                                        <div class="stat-label">–ß–∞—Å–æ–≤ –æ–±—É—á–µ–Ω–∏—è</div>
                                        <div class="stat-trend">+5—á –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ</div>
                                    </div>
                                </div>
                                <div class="stat-card large">
                                    <div class="stat-icon">üìà</div>
                                    <div class="stat-content">
                                        <div class="stat-value">${this.state.progress.level || '–ù–æ–≤–∏—á–æ–∫'}</div>
                                        <div class="stat-label">–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å</div>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: ${((this.state.progress.experience || 0) / 500) * 100}%"></div>
                                        </div>
                                        <span class="progress-text">${this.state.progress.experience || 0}/500 XP</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            // ==================== –ö–ê–†–¢–û–ß–ö–ò –ö–û–ù–¢–ï–ù–¢–ê ====================

            createCourseCard(course) {
                const imageUrl = course.image_url || 'https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=400&h=250&fit=crop';
                const videoUrl = course.video_url || '';
                const progress = this.state.progress.courses?.[course.id] || 0;
                const isEnrolled = progress > 0;
                const isCompleted = progress === 100;
                
                return `
                    <div class="content-card course-card" onclick="app.openCourseDetail(${course.id})">
                        <div class="card-image">
                            <img src="${imageUrl}" alt="${course.title}" 
                                 onerror="this.src='https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=400&h=250&fit=crop'">
                            <div class="card-overlay">
                                <button class="favorite-btn ${this.isFavorite(course.id, 'courses') ? 'active' : ''}" 
                                        onclick="event.stopPropagation(); app.toggleFavorite(${course.id}, 'courses')">
                                    ${this.isFavorite(course.id, 'courses') ? '‚ù§Ô∏è' : 'ü§ç'}
                                </button>
                                ${videoUrl ? `
                                <button class="preview-btn" onclick="event.stopPropagation(); app.previewContent('video', '${videoUrl}', {title: '${this.escapeHtml(course.title)}', id: ${course.id}})">
                                    üëÅÔ∏è
                                </button>
                                ` : ''}
                            </div>
                            ${course.featured ? '<div class="featured-badge">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º</div>' : ''}
                            ${course.discount > 0 ? `<div class="discount-badge">-${course.discount}%</div>` : ''}
                            ${isEnrolled ? `<div class="progress-badge">${isCompleted ? '‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω' : `üéØ ${progress}%`}</div>` : ''}
                        </div>
                        <div class="card-content">
                            <div class="card-category">${course.category || '–û–±—â–µ–µ'}</div>
                            <h3 class="card-title">${course.title}</h3>
                            <p class="card-description">${course.description || '–û–ø–∏—Å–∞–Ω–∏–µ –∫—É—Ä—Å–∞'}</p>
                            <div class="card-meta">
                                <span class="meta-item">üìä ${this.getLevelName(course.level)}</span>
                                <span class="meta-item">‚è±Ô∏è ${course.duration || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</span>
                                <span class="meta-item">üéØ ${course.modules || 0} –º–æ–¥—É–ª–µ–π</span>
                            </div>
                            
                            ${isEnrolled ? `
                            <div class="progress-section">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${progress}%"></div>
                                </div>
                                <span class="progress-text">${progress}% –∑–∞–≤–µ—Ä—à–µ–Ω–æ</span>
                            </div>
                            ` : ''}
                            
                            <div class="card-footer">
                                <div class="price-section">
                                    ${course.discount > 0 ? `
                                        <span class="price-original">${this.formatPrice(course.price)}</span>
                                    ` : ''}
                                    <span class="price-current">
                                        ${this.formatPrice(course.discount > 0 ? course.price * (1 - course.discount/100) : course.price)}
                                    </span>
                                </div>
                                <div class="action-buttons">
                                    ${isEnrolled ? `
                                        <button class="btn btn-success btn-small" onclick="event.stopPropagation(); app.continueCourse(${course.id})">
                                            ${isCompleted ? 'üëÅÔ∏è –ü–æ–≤—Ç–æ—Ä–∏—Ç—å' : 'üéØ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å'}
                                        </button>
                                    ` : this.currentUser?.hasActiveSubscription ? `
                                        <button class="btn btn-primary btn-small" onclick="event.stopPropagation(); app.enrollCourse(${course.id})">
                                            –ù–∞—á–∞—Ç—å
                                        </button>
                                    ` : `
                                        <button class="btn btn-primary btn-small" onclick="event.stopPropagation(); app.openCourseDetail(${course.id})">
                                            –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                                        </button>
                                    `}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            createPodcastCard(podcast) {
                const imageUrl = podcast.image_url || 'https://images.unsplash.com/photo-1478737270239-2f02b77fc618?w=400&h=250&fit=crop';
                const audioUrl = podcast.audio_url || '';
                const isListened = this.state.progress.podcasts?.[podcast.id];
                
                return `
                    <div class="content-card podcast-card" onclick="app.openPodcastDetail(${podcast.id})">
                        <div class="card-image">
                            <img src="${imageUrl}" alt="${podcast.title}" 
                                 onerror="this.src='https://images.unsplash.com/photo-1478737270239-2f02b77fc618?w=400&h=250&fit=crop'">
                            <div class="card-overlay">
                                <button class="favorite-btn ${this.isFavorite(podcast.id, 'podcasts') ? 'active' : ''}" 
                                        onclick="event.stopPropagation(); app.toggleFavorite(${podcast.id}, 'podcasts')">
                                    ${this.isFavorite(podcast.id, 'podcasts') ? '‚ù§Ô∏è' : 'ü§ç'}
                                </button>
                                <button class="play-btn" onclick="event.stopPropagation(); app.previewContent('audio', '${audioUrl}', {title: '${this.escapeHtml(podcast.title)}', cover: '${imageUrl}', id: ${podcast.id}})">
                                    ‚ñ∂Ô∏è
                                </button>
                            </div>
                            ${isListened ? '<div class="progress-badge">üéß –ü—Ä–æ—Å–ª—É—à–∞–Ω</div>' : ''}
                        </div>
                        <div class="card-content">
                            <div class="card-category">${podcast.category || '–û–±—â–µ–µ'}</div>
                            <h3 class="card-title">${podcast.title}</h3>
                            <p class="card-description">${podcast.description || '–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥–∫–∞—Å—Ç–∞'}</p>
                            <div class="card-meta">
                                <span class="meta-item">‚è±Ô∏è ${podcast.duration || '00:00'}</span>
                                <span class="meta-item">üéß ${podcast.listens || 0} –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π</span>
                            </div>
                        </div>
                    </div>
                `;
            }

            createStreamCard(stream) {
                const thumbnailUrl = stream.thumbnail_url || 'https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=400&h=250&fit=crop';
                const videoUrl = stream.video_url || '';
                const isWatched = this.state.progress.streams?.[stream.id];
                
                return `
                    <div class="content-card stream-card" onclick="app.openStreamDetail(${stream.id})">
                        <div class="card-image">
                            <img src="${thumbnailUrl}" alt="${stream.title}" 
                                 onerror="this.src='https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=400&h=250&fit=crop'">
                            <div class="card-overlay">
                                <button class="favorite-btn ${this.isFavorite(stream.id, 'streams') ? 'active' : ''}" 
                                        onclick="event.stopPropagation(); app.toggleFavorite(${stream.id}, 'streams')">
                                    ${this.isFavorite(stream.id, 'streams') ? '‚ù§Ô∏è' : 'ü§ç'}
                                </button>
                                <button class="play-btn" onclick="event.stopPropagation(); app.previewContent('video', '${videoUrl}', {title: '${this.escapeHtml(stream.title)}', id: ${stream.id}})">
                                    ‚ñ∂Ô∏è
                                </button>
                            </div>
                            ${stream.is_live ? `
                            <div class="live-badge">
                                <div class="live-pulse"></div>
                                LIVE
                            </div>
                            ` : ''}
                            ${isWatched ? '<div class="progress-badge">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ</div>' : ''}
                        </div>
                        <div class="card-content">
                            <div class="card-category">${stream.category || '–û–±—â–µ–µ'}</div>
                            <h3 class="card-title">${stream.title}</h3>
                            <p class="card-description">${stream.description || '–û–ø–∏—Å–∞–Ω–∏–µ —ç—Ñ–∏—Ä–∞'}</p>
                            <div class="card-meta">
                                <span class="meta-item">‚è±Ô∏è ${stream.duration || '00:00'}</span>
                                <span class="meta-item">üë• ${stream.participants || 0} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</span>
                                ${stream.scheduled_start ? `
                                <span class="meta-item">üìÖ ${new Date(stream.scheduled_start).toLocaleDateString('ru-RU')}</span>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }

            createEventCard(event) {
                const imageUrl = event.image_url || 'https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=400&h=250&fit=crop';
                const isRegistered = this.state.progress.events?.[event.id]?.registered;
                const eventDate = new Date(event.event_date);
                const isUpcoming = eventDate > new Date();
                
                return `
                    <div class="content-card event-card">
                        <div class="card-image">
                            <img src="${imageUrl}" alt="${event.title}" 
                                 onerror="this.src='https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=400&h=250&fit=crop'">
                            <div class="card-overlay">
                                <button class="favorite-btn ${this.isFavorite(event.id, 'events') ? 'active' : ''}" 
                                        onclick="event.stopPropagation(); app.toggleFavorite(${event.id}, 'events')">
                                    ${this.isFavorite(event.id, 'events') ? '‚ù§Ô∏è' : 'ü§ç'}
                                </button>
                            </div>
                            ${isRegistered ? '<div class="progress-badge">‚úÖ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω</div>' : ''}
                        </div>
                        <div class="card-content">
                            <div class="card-category">${event.event_type === 'online' ? 'üåê –û–Ω–ª–∞–π–Ω' : event.event_type === 'offline' ? 'üèõÔ∏è –û—Ñ–ª–∞–π–Ω' : 'üîÄ –ì–∏–±—Ä–∏–¥'} ‚Ä¢ ${event.category || '–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ'}</div>
                            <h3 class="card-title">${event.title}</h3>
                            <p class="card-description">${event.description}</p>
                            <div class="card-meta">
                                <span class="meta-item">üìÖ ${eventDate.toLocaleDateString('ru-RU')}</span>
                                <span class="meta-item">‚è∞ ${eventDate.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' })}</span>
                                <span class="meta-item">üë• ${event.participants || 0} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</span>
                            </div>
                            <div class="card-footer">
                                ${isUpcoming ? `
                                    ${!isRegistered ? `
                                    <button class="btn btn-primary btn-small" onclick="app.registerForEvent(${event.id})">
                                        –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                                    </button>
                                    ` : `
                                    <button class="btn btn-outline btn-small" onclick="app.cancelEventRegistration(${event.id})">
                                        –û—Ç–º–µ–Ω–∏—Ç—å
                                    </button>
                                    `}
                                ` : `
                                    <button class="btn btn-outline btn-small" onclick="app.openEventDetail(${event.id})">
                                        –°–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø–∏—Å—å
                                    </button>
                                `}
                            </div>
                        </div>
                    </div>
                `;
            }

            // ==================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –ú–ï–¢–û–î–´ ====================

            setupEventListeners() {
                // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.handleBackButton();
                    }
                    if (e.ctrlKey && e.key === 'k') {
                        e.preventDefault();
                        this.focusSearch();
                    }
                });

                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                document.addEventListener('click', (e) => {
                    if (e.target.matches('.nav-btn')) {
                        const page = e.target.dataset.page;
                        this.renderPage(page);
                    }
                });

                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
                document.addEventListener('click', (e) => {
                    if (e.target.matches('.modal')) {
                        this.closeAllModals();
                    }
                });

                console.log('‚úÖ –í—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã');
            }

            initializePageComponents() {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                this.initializeVideoPlayers();
                this.initializeAudioPlayers();
                this.initializeFilters();
                this.initializeTabs();
            }

            initializeVideoPlayers() {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–∏–¥–µ–æ –ø–ª–µ–µ—Ä–æ–≤
                document.querySelectorAll('video').forEach(video => {
                    video.addEventListener('play', () => {
                        if (this.mediaPlayers.video && this.mediaPlayers.video !== video) {
                            this.mediaPlayers.video.pause();
                        }
                        this.mediaPlayers.video = video;
                    });
                });
            }

            initializeAudioPlayers() {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—É–¥–∏–æ –ø–ª–µ–µ—Ä–æ–≤
                document.querySelectorAll('audio').forEach(audio => {
                    audio.addEventListener('play', () => {
                        if (this.mediaPlayers.audio && this.mediaPlayers.audio !== audio) {
                            this.mediaPlayers.audio.pause();
                        }
                        this.mediaPlayers.audio = audio;
                    });
                });
            }

            initializeFilters() {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
                document.querySelectorAll('.filter-select').forEach(select => {
                    select.addEventListener('change', (e) => {
                        const type = e.target.id.replace('Filter', '');
                        this.applyFilter(type, 'category', e.target.value);
                    });
                });
            }

            initializeTabs() {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–±–æ–≤
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const tabName = e.target.textContent.trim();
                        this.switchTab(tabName);
                    });
                });
            }

            // ==================== –î–ï–ú–û-–î–ê–ù–ù–´–ï ====================

            createDemoUser() {
                this.currentUser = {
                    id: 898508164,
                    firstName: '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä',
                    lastName: '–ü–µ—Ç—Ä–æ–≤',
                    email: 'alexander@example.com',
                    phone: '+7 (999) 123-45-67',
                    isAdmin: true,
                    isSuperAdmin: true,
                    isVerified: true,
                    isPremium: true,
                    subscriptionEnd: new Date('2025-12-31').toISOString(),
                    hasActiveSubscription: true,
                    avatarUrl: null,
                    joinDate: new Date('2024-01-15').toISOString(),
                    token: 'demo-token-12345',
                    favorites: {
                        courses: [1, 3],
                        podcasts: [1],
                        streams: [1],
                        videos: [1, 2],
                        materials: [1],
                        events: [1]
                    }
                };
                
                this.isAdmin = true;
                this.isSuperAdmin = true;
            }

            createDemoContent() {
                this.allContent = this.getDemoContentData();
            }

            getDemoContentData() {
                return {
                    courses: [
                        {
                            id: 1,
                            title: '–ú–∞–Ω—É–∞–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –≤ –ø—Ä–∞–∫—Ç–∏–∫–µ –Ω–µ–≤—Ä–æ–ª–æ–≥–∞',
                            description: '6 –º–æ–¥—É–ª–µ–π –ø–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –º–∞–Ω—É–∞–ª—å–Ω—ã–º –º–µ—Ç–æ–¥–∏–∫–∞–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ –ª–µ—á–µ–Ω–∏—è –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –ø–æ–∑–≤–æ–Ω–æ—á–Ω–∏–∫–∞',
                            price: 25000,
                            discount: 16,
                            duration: '12 –Ω–µ–¥–µ–ª—å',
                            modules: 6,
                            category: '–ú–∞–Ω—É–∞–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏',
                            level: 'advanced',
                            students_count: 156,
                            rating: 4.8,
                            featured: true,
                            image_url: 'https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=400&h=250&fit=crop',
                            video_url: '',
                            created_at: new Date().toISOString(),
                            instructors: [1, 2]
                        },
                        {
                            id: 2,
                            title: '–ù–µ–≤—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞',
                            description: '5 –º–æ–¥—É–ª–µ–π –ø–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ –Ω–µ–≤—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π',
                            price: 18000,
                            discount: 0,
                            duration: '8 –Ω–µ–¥–µ–ª—å',
                            modules: 5,
                            category: '–ù–µ–≤—Ä–æ–ª–æ–≥–∏—è',
                            level: 'intermediate',
                            students_count: 234,
                            rating: 4.6,
                            featured: true,
                            image_url: 'https://images.unsplash.com/photo-1551601651-2a8555f1a136?w=400&h=250&fit=crop',
                            video_url: '',
                            created_at: new Date().toISOString(),
                            instructors: [1]
                        }
                    ],
                    podcasts: [
                        {
                            id: 1,
                            title: '–ê–ù–ë FM: –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ–≤—Ä–æ–ª–æ–≥–∏—è',
                            description: '–û–±—Å—É–∂–¥–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ–Ω–¥–µ–Ω—Ü–∏–π –≤ –Ω–µ–≤—Ä–æ–ª–æ–≥–∏–∏',
                            duration: '45:20',
                            category: '–ù–µ–≤—Ä–æ–ª–æ–≥–∏—è',
                            listens: 2345,
                            image_url: 'https://images.unsplash.com/photo-1478737270239-2f02b77fc618?w=400&h=250&fit=crop',
                            audio_url: '',
                            created_at: new Date().toISOString()
                        }
                    ],
                    streams: [
                        {
                            id: 1,
                            title: 'LIVE: –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –º–∞–Ω—É–∞–ª—å–Ω–æ–π —Ç–µ—Ä–∞–ø–∏–∏',
                            description: '–ü—Ä—è–º–æ–π —ç—Ñ–∏—Ä —Å –æ—Ç–≤–µ—Ç–∞–º–∏ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã',
                            duration: '2:15:00',
                            category: '–ú–∞–Ω—É–∞–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏',
                            participants: 156,
                            is_live: true,
                            viewers: 89,
                            likes: 23,
                            thumbnail_url: 'https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=400&h=250&fit=crop',
                            video_url: '',
                            scheduled_start: new Date(Date.now() + 3600000).toISOString(),
                            created_at: new Date().toISOString()
                        }
                    ],
                    events: [
                        {
                            id: 1,
                            title: '–ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è –ø–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–µ–≤—Ä–æ–ª–æ–≥–∏–∏',
                            description: '–ï–∂–µ–≥–æ–¥–Ω–∞—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è —Å –≤–µ–¥—É—â–∏–º–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º–∏',
                            event_type: 'offline',
                            event_date: '2024-12-15T10:00:00.000Z',
                            location: '–ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è, 15',
                            participants: 250,
                            image_url: 'https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=400&h=250&fit=crop',
                            registration_url: '',
                            created_at: new Date().toISOString()
                        }
                    ],
                    news: [
                        {
                            id: 1,
                            title: '–ù–æ–≤—ã–µ –º–µ—Ç–æ–¥–∏–∫–∏ –≤ —Ä–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏–∏ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ —Å –∏–Ω—Å—É–ª—å—Ç–æ–º',
                            description: '–û–±–∑–æ—Ä —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ —Ä–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏–∏',
                            content: '–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏...',
                            date: '15 –¥–µ–∫ 2024',
                            category: '–†–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏—è',
                            type: '–°—Ç–∞—Ç—å—è',
                            image_url: 'https://images.unsplash.com/photo-1576091160399-112ba8d25d1f?w=400&h=250&fit=crop',
                            created_at: new Date().toISOString()
                        }
                    ],
                    stats: {
                        totalUsers: 1567,
                        totalCourses: 4,
                        totalMaterials: 3,
                        totalEvents: 3
                    }
                };
            }

            loadNavigation() {
                this.navigationItems = [
                    { 
                        id: 1, 
                        title: '–ö—É—Ä—Å—ã', 
                        page: 'courses', 
                        icon: 'üìö',
                        description: '–°–∏—Å—Ç–µ–º–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏',
                        image_url: 'https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=400&h=250&fit=crop'
                    },
                    { 
                        id: 2, 
                        title: '–ü–æ–¥–∫–∞—Å—Ç—ã', 
                        page: 'podcasts', 
                        icon: 'üéß',
                        description: '–ê—É–¥–∏–æ—É—Ä–æ–∫–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –≤ –¥–æ—Ä–æ–≥–µ',
                        image_url: 'https://images.unsplash.com/photo-1478737270239-2f02b77fc618?w=400&h=250&fit=crop'
                    },
                    { 
                        id: 3, 
                        title: '–≠—Ñ–∏—Ä—ã', 
                        page: 'streams', 
                        icon: 'üìπ',
                        description: '–ü—Ä—è–º—ã–µ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏ —Å —ç–∫—Å–ø–µ—Ä—Ç–∞–º–∏',
                        image_url: 'https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=400&h=250&fit=crop'
                    },
                    { 
                        id: 4, 
                        title: '–í–∏–¥–µ–æ', 
                        page: 'videos', 
                        icon: 'üéØ',
                        description: '–ö–æ—Ä–æ—Ç–∫–∏–µ –æ–±—É—á–∞—é—â–∏–µ –≤–∏–¥–µ–æ',
                        image_url: 'https://images.unsplash.com/photo-1551601651-2a8555f1a136?w=400&h=250&fit=crop'
                    },
                    { 
                        id: 5, 
                        title: '–ú–∞—Ç–µ—Ä–∏–∞–ª—ã', 
                        page: 'materials', 
                        icon: 'üìã',
                        description: '–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏, —Å—Ç–∞—Ç—å–∏ –∏ –º–µ—Ç–æ–¥–∏—á–∫–∏',
                        image_url: 'https://images.unsplash.com/photo-1589998059171-988d887df646?w=400&h=250&fit=crop'
                    },
                    { 
                        id: 6, 
                        title: '–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è', 
                        page: 'events', 
                        icon: 'üó∫Ô∏è',
                        description: '–ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏ –∏ —Å–µ–º–∏–Ω–∞—Ä—ã',
                        image_url: 'https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=400&h=250&fit=crop'
                    }
                ];
            }

            loadSubscriptionData() {
                this.subscriptionPlans = [
                    {
                        id: 1,
                        name: '–ë–∞–∑–æ–≤—ã–π',
                        description: '–î–æ—Å—Ç—É–ø –∫ –æ—Å–Ω–æ–≤–Ω—ã–º –∫—É—Ä—Å–∞–º',
                        price_monthly: 2900,
                        price_quarterly: 7500,
                        price_yearly: 27000,
                        features: JSON.stringify(['–î–æ—Å—Ç—É–ø –∫ 3 –∫—É—Ä—Å–∞–º', '–ë–∞–∑–æ–≤—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã', '–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ email'])
                    }
                ];

                this.userSubscription = {
                    plan_id: 2,
                    plan_name: '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π',
                    plan_type: 'monthly',
                    price: 5900,
                    starts_at: new Date().toISOString(),
                    ends_at: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString()
                };
            }

            loadInstructors() {
                this.instructors = [
                    {
                        id: 1,
                        name: '–î–æ–∫—Ç–æ—Ä –ò–≤–∞–Ω–æ–≤ –ê.–í.',
                        specialization: '–ù–µ–≤—Ä–æ–ª–æ–≥–∏—è, –ú–∞–Ω—É–∞–ª—å–Ω–∞—è —Ç–µ—Ä–∞–ø–∏—è',
                        role: '–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç',
                        experience_years: 15,
                        bio: '–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –º–∞–Ω—É–∞–ª—å–Ω–æ–π —Ç–µ—Ä–∞–ø–∏–∏, –∞–≤—Ç–æ—Ä –º–µ—Ç–æ–¥–∏–∫ –ª–µ—á–µ–Ω–∏—è –±–æ–ª–µ–π –≤ —Å–ø–∏–Ω–µ.',
                        avatar_url: 'https://images.unsplash.com/photo-1612349317150-e413f6a5b16d?w=300&h=300&fit=crop&crop=face',
                        email: 'ivanov@anb.ru'
                    }
                ];
            }

            loadUserProgress() {
                this.state.progress = {
                    level: '–ü–æ–Ω–∏–º–∞—é',
                    experience: 1250,
                    completedCourses: 2,
                    completedModules: 8,
                    studyHours: 45,
                    weeklyHours: 5,
                    courses: {
                        1: 75,
                        2: 100
                    },
                    podcasts: {
                        1: true
                    },
                    videos: {
                        1: true,
                        2: true
                    },
                    streams: {
                        1: false
                    },
                    materials: {
                        1: true
                    },
                    events: {
                        1: { registered: true, attended: false }
                    }
                };
            }

            // ==================== –£–¢–ò–õ–ò–¢–´ ====================

            escapeHtml(text) {
                if (!text) return '';
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            formatPrice(price) {
                return new Intl.NumberFormat('ru-RU').format(Math.round(price)) + ' ‚ÇΩ';
            }

            getLevelName(level) {
                const levels = {
                    'beginner': '–ù–∞—á–∏–Ω–∞—é—â–∏–π',
                    'intermediate': '–°—Ä–µ–¥–Ω–∏–π',
                    'advanced': '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π'
                };
                return levels[level] || level;
            }

            isFavorite(contentId, contentType) {
                return this.state.favorites[contentType]?.includes(parseInt(contentId)) || false;
            }

            getTotalFavorites() {
                return Object.values(this.state.favorites).flat().length;
            }

            getContentCount(page) {
                const counts = {
                    'courses': this.allContent.courses?.length || 0,
                    'podcasts': this.allContent.podcasts?.length || 0,
                    'videos': this.allContent.videos?.length || 0,
                    'materials': this.allContent.materials?.length || 0,
                    'streams': this.allContent.streams?.length || 0,
                    'events': this.allContent.events?.length || 0
                };
                return counts[page] || 0;
            }

            calculateHomeStats() {
                return {
                    courses: this.allContent.stats?.totalCourses || this.allContent.courses?.length || 0,
                    students: this.allContent.stats?.totalUsers || 1567,
                    experts: 25,
                    materials: this.allContent.materials?.length || 0
                };
            }

            getRecommendedCourses() {
                return this.allContent.courses?.filter(course => course.featured) || [];
            }

            getLiveStreams() {
                return this.allContent.streams?.filter(stream => stream.is_live) || [];
            }

            getUpcomingEvents() {
                return this.allContent.events?.filter(event => new Date(event.event_date) > new Date()) || [];
            }

            createNewsItems() {
                const news = this.allContent.news || [];
                return news.map(item => `
                    <div class="content-card">
                        <div class="card-image">
                            <img src="${item.image_url}" alt="${item.title}" 
                                 onerror="this.src='https://images.unsplash.com/photo-1576091160399-112ba8d25d1f?w=400&h=250&fit=crop'">
                        </div>
                        <div class="card-content">
                            <div class="card-category">${item.category} ‚Ä¢ ${item.type}</div>
                            <h3 class="card-title">${item.title}</h3>
                            <p class="card-description">${item.description}</p>
                            <div class="card-meta">
                                <span class="meta-item">üìÖ ${item.date}</span>
                            </div>
                            <button class="btn btn-outline btn-small" onclick="app.readNews(${item.id})">
                                –ß–∏—Ç–∞—Ç—å
                            </button>
                        </div>
                    </div>
                `).join('');
            }

            // ==================== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô ====================

            handleBackButton() {
                if (this.currentSubPage) {
                    this.currentSubPage = '';
                    this.renderPage(this.currentPage);
                } else if (this.currentPage !== 'home') {
                    this.renderPage('home');
                }
            }

            handleSearchInput(value) {
                this.searchTerm = value;
            }

            handleSearchKeypress(event) {
                if (event.key === 'Enter') {
                    this.performSearch();
                }
            }

            performSearch() {
                if (this.searchTerm.trim()) {
                    this.renderPage('search');
                }
            }

            toggleFavorite(contentId, contentType, event = null) {
                if (event) {
                    event.stopPropagation();
                    event.preventDefault();
                }
                
                const wasFavorite = this.isFavorite(contentId, contentType);
                
                if (wasFavorite) {
                    this.state.favorites[contentType] = this.state.favorites[contentType].filter(id => id !== contentId);
                    this.showNotification('üíî –£–¥–∞–ª–µ–Ω–æ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ', 'info');
                } else {
                    if (!this.state.favorites[contentType].includes(contentId)) {
                        this.state.favorites[contentType].push(contentId);
                    }
                    this.showNotification('‚ù§Ô∏è –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ', 'success');
                }
                
                this.updateFavoritesCount();
                this.saveState();
                
                if (this.currentPage === 'favorites') {
                    this.renderPage('favorites');
                }
            }

            updateFavoritesCount() {
                const favoritesCount = document.getElementById('favoritesCount');
                if (favoritesCount) {
                    const totalFavorites = this.getTotalFavorites();
                    favoritesCount.textContent = totalFavorites;
                    favoritesCount.style.display = totalFavorites > 0 ? 'flex' : 'none';
                }
            }

            updateAllCounters() {
                this.updateFavoritesCount();
            }

            updateActiveNav() {
                document.querySelectorAll('.bottom-nav .nav-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.page === this.currentPage) {
                        btn.classList.add('active');
                    }
                });

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–µ–π–¥–∂ –∞–¥–º–∏–Ω–∞ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                const adminBadge = document.getElementById('adminBadge');
                if (adminBadge) {
                    adminBadge.style.display = this.isAdmin ? 'block' : 'none';
                }
            }

            applyFilter(contentType, filterType, value) {
                this.filters[contentType][filterType] = value;
                this.renderPage(contentType);
            }

            filterNews(category) {
                this.currentNewsFilter = category;
                this.renderPage('home');
            }

            // ==================== –ú–ï–¢–û–î–´ –î–õ–Ø –û–¢–ö–†–´–¢–ò–Ø –î–ï–¢–ê–õ–ï–ô ====================

            openCourseDetail(courseId) {
                this.currentSubPage = `course-${courseId}`;
                this.renderPage('courses', `course-${courseId}`);
            }

            openPodcastDetail(podcastId) {
                this.currentSubPage = `podcast-${podcastId}`;
                this.renderPage('podcasts', `podcast-${podcastId}`);
            }

            openStreamDetail(streamId) {
                this.currentSubPage = `stream-${streamId}`;
                this.renderPage('streams', `stream-${streamId}`);
            }

            openEventDetail(eventId) {
                this.currentSubPage = `event-${eventId}`;
                this.renderPage('events', `event-${eventId}`);
            }

            // ==================== –ú–ï–î–ò–ê –ü–õ–ï–ï–† ====================

            previewContent(type, url, metadata) {
                const modal = document.getElementById('mediaModal');
                const modalTitle = document.getElementById('mediaModalTitle');
                const modalBody = document.getElementById('mediaModalBody');
                
                if (!modal || !modalTitle || !modalBody) return;
                
                modalTitle.textContent = metadata.title;
                
                if (type === 'video') {
                    modalBody.innerHTML = `
                        <div class="media-player">
                            <video controls autoplay style="width: 100%;">
                                <source src="${url}" type="video/mp4">
                                –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                            </video>
                        </div>
                    `;
                } else if (type === 'audio') {
                    modalBody.innerHTML = `
                        <div class="audio-player">
                            <div class="audio-info">
                                <img src="${metadata.cover}" alt="${metadata.title}" class="audio-cover">
                                <div class="audio-details">
                                    <div class="audio-title">${metadata.title}</div>
                                    <div class="audio-author">–ê–∫–∞–¥–µ–º–∏—è –ê–ù–ë</div>
                                </div>
                            </div>
                            <div class="audio-controls">
                                <button class="control-btn" onclick="app.audioControl('rewind')">‚èÆÔ∏è</button>
                                <button class="control-btn" onclick="app.audioControl('play')">‚ñ∂Ô∏è</button>
                                <button class="control-btn" onclick="app.audioControl('pause')">‚è∏Ô∏è</button>
                                <button class="control-btn" onclick="app.audioControl('forward')">‚è≠Ô∏è</button>
                            </div>
                            <div class="audio-progress">
                                <div class="progress-bar-container" onclick="app.setAudioPosition(event)">
                                    <div class="progress-bar-fill" id="audioProgress"></div>
                                </div>
                                <div class="time-display">
                                    <span id="currentTime">0:00</span>
                                    <span id="totalTime">0:00</span>
                                </div>
                            </div>
                            <audio id="audioPlayer" style="display: none;">
                                <source src="${url}" type="audio/mpeg">
                                –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ.
                            </audio>
                        </div>
                    `;
                    
                    this.initializeAudioPlayer(metadata.id);
                }
                
                modal.classList.add('active');
            }

            initializeAudioPlayer(audioId) {
                const audio = document.getElementById('audioPlayer');
                if (!audio) return;
                
                this.currentAudioPlayer = {
                    element: audio,
                    id: audioId,
                    isPlaying: false
                };
                
                audio.addEventListener('loadedmetadata', () => {
                    const totalTime = document.getElementById('totalTime');
                    if (totalTime) {
                        totalTime.textContent = this.formatTime(audio.duration);
                    }
                });
                
                audio.addEventListener('timeupdate', () => {
                    const progress = document.getElementById('audioProgress');
                    const currentTime = document.getElementById('currentTime');
                    
                    if (progress && currentTime) {
                        const percent = (audio.currentTime / audio.duration) * 100;
                        progress.style.width = `${percent}%`;
                        currentTime.textContent = this.formatTime(audio.currentTime);
                    }
                });
                
                audio.addEventListener('ended', () => {
                    this.markAsCompleted(audioId, 'podcasts');
                });
            }

            audioControl(action) {
                if (!this.currentAudioPlayer) return;
                
                const audio = this.currentAudioPlayer.element;
                
                switch (action) {
                    case 'play':
                        audio.play();
                        this.currentAudioPlayer.isPlaying = true;
                        break;
                    case 'pause':
                        audio.pause();
                        this.currentAudioPlayer.isPlaying = false;
                        break;
                    case 'rewind':
                        audio.currentTime = Math.max(0, audio.currentTime - 10);
                        break;
                    case 'forward':
                        audio.currentTime = Math.min(audio.duration, audio.currentTime + 10);
                        break;
                }
            }

            setAudioPosition(event) {
                if (!this.currentAudioPlayer) return;
                
                const audio = this.currentAudioPlayer.element;
                const progressBar = event.currentTarget;
                const clickX = event.offsetX;
                const width = progressBar.offsetWidth;
                const duration = audio.duration;
                
                audio.currentTime = (clickX / width) * duration;
            }

            formatTime(seconds) {
                const mins = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
            }

            closeMediaModal() {
                const modal = document.getElementById('mediaModal');
                if (modal) {
                    modal.classList.remove('active');
                }
                
                if (this.currentAudioPlayer) {
                    this.currentAudioPlayer.element.pause();
                    this.currentAudioPlayer = null;
                }
                
                if (this.currentVideoPlayer) {
                    this.currentVideoPlayer.pause();
                    this.currentVideoPlayer = null;
                }
            }

            // ==================== –ü–û–î–ü–ò–°–ö–ò ====================

            showSubscriptionModal() {
                const modal = document.getElementById('subscriptionModal');
                const modalBody = document.getElementById('subscriptionModalBody');
                
                if (!modal || !modalBody) return;
                
                modalBody.innerHTML = `
                    <div class="subscription-plans">
                        <h3 style="margin-bottom: 1.5rem;">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É</h3>
                        <div class="content-grid">
                            ${this.subscriptionPlans.map(plan => `
                                <div class="content-card" onclick="app.selectSubscriptionPlan(${plan.id})">
                                    <div class="card-content">
                                        <h3 class="card-title">${plan.name}</h3>
                                        <p class="card-description">${plan.description}</p>
                                        <div class="price-section" style="margin: 1rem 0;">
                                            <span class="price-current">${this.formatPrice(plan.price_monthly)}/–º–µ—Å</span>
                                        </div>
                                        <ul style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 1rem;">
                                            ${JSON.parse(plan.features).map(feature => `<li>${feature}</li>`).join('')}
                                        </ul>
                                        <button class="btn btn-primary btn-small">
                                            –í—ã–±—Ä–∞—Ç—å
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                
                modal.classList.add('active');
            }

            selectSubscriptionPlan(planId) {
                this.subscriptionState.selectedPlan = this.subscriptionPlans.find(p => p.id === planId);
                this.showNotification(`–í—ã–±—Ä–∞–Ω –ø–ª–∞–Ω: ${this.subscriptionState.selectedPlan.name}`, 'success');
            }

            processSubscription() {
                if (!this.subscriptionState.selectedPlan) {
                    this.showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –ø–ª–∞–Ω –ø–æ–¥–ø–∏—Å–∫–∏', 'error');
                    return;
                }
                
                this.showNotification('–ü–æ–¥–ø–∏—Å–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞!', 'success');
                this.closeSubscriptionModal();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                this.currentUser.hasActiveSubscription = true;
                this.userSubscription = {
                    plan_id: this.subscriptionState.selectedPlan.id,
                    plan_name: this.subscriptionState.selectedPlan.name,
                    plan_type: 'monthly',
                    price: this.subscriptionState.selectedPlan.price_monthly,
                    starts_at: new Date().toISOString(),
                    ends_at: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString()
                };
            }

            closeSubscriptionModal() {
                const modal = document.getElementById('subscriptionModal');
                if (modal) {
                    modal.classList.remove('active');
                }
            }

            // ==================== –ù–ê–°–¢–†–û–ô–ö–ò ====================

            showSettingsModal() {
                const modal = document.getElementById('settingsModal');
                const modalBody = document.getElementById('settingsModalBody');
                
                if (!modal || !modalBody) return;
                
                modalBody.innerHTML = `
                    <div class="settings-content">
                        <h3 style="margin-bottom: 1.5rem;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h3>
                        
                        <div class="form-group">
                            <label class="form-label">–¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</label>
                            <select class="form-select" id="themeSelect">
                                <option value="dark" ${this.state.settings.theme === 'dark' ? 'selected' : ''}>–¢—ë–º–Ω–∞—è</option>
                                <option value="light" ${this.state.settings.theme === 'light' ? 'selected' : ''}>–°–≤–µ—Ç–ª–∞—è</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">–Ø–∑—ã–∫</label>
                            <select class="form-select" id="languageSelect">
                                <option value="ru" ${this.state.settings.language === 'ru' ? 'selected' : ''}>–†—É—Å—Å–∫–∏–π</option>
                                <option value="en" ${this.state.settings.language === 'en' ? 'selected' : ''}>English</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="notificationsToggle" ${this.state.settings.notifications ? 'checked' : ''}>
                                <span>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                            </label>
                        </div>
                        
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="autoPlayToggle" ${this.state.settings.autoPlay ? 'checked' : ''}>
                                <span>–ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ</span>
                            </label>
                        </div>
                    </div>
                `;
                
                modal.classList.add('active');
            }

            saveSettings() {
                const themeSelect = document.getElementById('themeSelect');
                const languageSelect = document.getElementById('languageSelect');
                const notificationsToggle = document.getElementById('notificationsToggle');
                const autoPlayToggle = document.getElementById('autoPlayToggle');
                
                if (themeSelect) this.state.settings.theme = themeSelect.value;
                if (languageSelect) this.state.settings.language = languageSelect.value;
                if (notificationsToggle) this.state.settings.notifications = notificationsToggle.checked;
                if (autoPlayToggle) this.state.settings.autoPlay = autoPlayToggle.checked;
                
                this.applySettings();
                this.saveState();
                this.showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
                this.closeSettingsModal();
            }

            closeSettingsModal() {
                const modal = document.getElementById('settingsModal');
                if (modal) {
                    modal.classList.remove('active');
                }
            }

            closeAllModals() {
                this.closeMediaModal();
                this.closeSubscriptionModal();
                this.closeSettingsModal();
            }

            // ==================== –°–ò–°–¢–ï–ú–ê –ü–†–û–ì–†–ï–°–°–ê ====================

            markAsCompleted(contentId, contentType) {
                if (!this.state.progress[contentType]) {
                    this.state.progress[contentType] = {};
                }
                
                this.state.progress[contentType][contentId] = true;
                
                // –ù–∞—á–∏—Å–ª—è–µ–º –æ–ø—ã—Ç
                if (!this.state.progress.experience) {
                    this.state.progress.experience = 0;
                }
                
                const experienceGained = {
                    'courses': 100,
                    'podcasts': 10,
                    'videos': 5,
                    'streams': 15,
                    'materials': 3,
                    'events': 20
                };
                
                this.state.progress.experience += experienceGained[contentType] || 0;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —É—Ä–æ–≤–µ–Ω—å
                this.updateUserLevel();
                
                this.saveState();
                this.showNotification('–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω! +' + (experienceGained[contentType] || 0) + ' XP', 'success');
            }

            updateUserLevel() {
                const experience = this.state.progress.experience || 0;
                
                if (experience >= 3000) {
                    this.state.progress.level = '–≠–∫—Å–ø–µ—Ä—Ç';
                } else if (experience >= 1500) {
                    this.state.progress.level = '–ü—Ä–∞–∫—Ç–∏–∫';
                } else if (experience >= 500) {
                    this.state.progress.level = '–ü–æ–Ω–∏–º–∞—é';
                } else {
                    this.state.progress.level = '–ù–æ–≤–∏—á–æ–∫';
                }
            }

            // ==================== –ó–ê–ì–õ–£–®–ö–ò –î–õ–Ø –û–°–¢–ê–õ–¨–ù–´–• –°–¢–†–ê–ù–ò–¶ ====================

            createCoursesPage() {
                const currentFilters = this.filters.courses;
                const courses = this.allContent.courses || [];
                
                return `
                    <div class="page">
                        <div class="detail-header">
                            <button class="back-btn" onclick="app.renderPage('home')">‚Üê –ù–∞–∑–∞–¥</button>
                            <h1>üìö –í—Å–µ –∫—É—Ä—Å—ã</h1>
                        </div>

                        <div class="content-filters">
                            <div class="filter-group">
                                <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                                <select class="filter-select" onchange="app.applyFilter('courses', 'category', this.value)">
                                    <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                                    <option value="–ú–∞–Ω—É–∞–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏" ${currentFilters.category === '–ú–∞–Ω—É–∞–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏' ? 'selected' : ''}>–ú–∞–Ω—É–∞–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏</option>
                                    <option value="–ù–µ–≤—Ä–æ–ª–æ–≥–∏—è" ${currentFilters.category === '–ù–µ–≤—Ä–æ–ª–æ–≥–∏—è' ? 'selected' : ''}>–ù–µ–≤—Ä–æ–ª–æ–≥–∏—è</option>
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label>–£—Ä–æ–≤–µ–Ω—å:</label>
                                <select class="filter-select" onchange="app.applyFilter('courses', 'level', this.value)">
                                    <option value="all">–í—Å–µ —É—Ä–æ–≤–Ω–∏</option>
                                    <option value="beginner" ${currentFilters.level === 'beginner' ? 'selected' : ''}>–ù–∞—á–∏–Ω–∞—é—â–∏–π</option>
                                    <option value="intermediate" ${currentFilters.level === 'intermediate' ? 'selected' : ''}>–°—Ä–µ–¥–Ω–∏–π</option>
                                    <option value="advanced" ${currentFilters.level === 'advanced' ? 'selected' : ''}>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</option>
                                </select>
                            </div>
                        </div>

                        <div class="content-grid">
                            ${courses.length > 0 ? courses.map(course => this.createCourseCard(course)).join('') : `
                                <div class="empty-state">
                                    <div class="empty-icon">üìö</div>
                                    <div class="empty-title">–ö—É—Ä—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>
                                    <div class="empty-description">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏</div>
                                </div>
                            `}
                        </div>
                    </div>
                `;
            }

            createPodcastsPage() {
                const podcasts = this.allContent.podcasts || [];
                
                return `
                    <div class="page">
                        <div class="detail-header">
                            <button class="back-btn" onclick="app.renderPage('home')">‚Üê –ù–∞–∑–∞–¥</button>
                            <h1>üéß –ü–æ–¥–∫–∞—Å—Ç—ã</h1>
                        </div>

                        <div class="content-grid">
                            ${podcasts.length > 0 ? podcasts.map(podcast => this.createPodcastCard(podcast)).join('') : `
                                <div class="empty-state">
                                    <div class="empty-icon">üéß</div>
                                    <div class="empty-title">–ü–æ–¥–∫–∞—Å—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>
                                    <div class="empty-description">–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –Ω–æ–≤—ã–µ –≤—ã–ø—É—Å–∫–∏</div>
                                </div>
                            `}
                        </div>
                    </div>
                `;
            }

            createStreamsPage() {
                const streams = this.allContent.streams || [];
                const liveStreams = streams.filter(s => s.is_live);
                const recordedStreams = streams.filter(s => !s.is_live);
                
                return `
                    <div class="page">
                        <div class="detail-header">
                            <button class="back-btn" onclick="app.renderPage('home')">‚Üê –ù–∞–∑–∞–¥</button>
                            <h1>üìπ –≠—Ñ–∏—Ä—ã –∏ —Ä–∞–∑–±–æ—Ä—ã</h1>
                        </div>

                        ${liveStreams.length > 0 ? `
                        <div class="live-section">
                            <h2 class="section-title">üî¥ –ü—Ä—è–º–æ–π —ç—Ñ–∏—Ä</h2>
                            <div class="content-grid">
                                ${liveStreams.map(stream => this.createStreamCard(stream)).join('')}
                            </div>
                        </div>
                        ` : ''}
                        
                        <div class="recorded-section">
                            <h2 class="section-title">üìπ –ó–∞–ø–∏—Å–∏ —ç—Ñ–∏—Ä–æ–≤</h2>
                            <div class="content-grid">
                                ${recordedStreams.length > 0 ? recordedStreams.map(stream => this.createStreamCard(stream)).join('') : `
                                    <div class="empty-state">
                                        <div class="empty-icon">üìπ</div>
                                        <div class="empty-title">–ó–∞–ø–∏—Å–µ–π –ø–æ–∫–∞ –Ω–µ—Ç</div>
                                        <div class="empty-description">–°–ª–µ–¥–∏—Ç–µ –∑–∞ –∞–Ω–æ–Ω—Å–∞–º–∏ –Ω–æ–≤—ã—Ö —ç—Ñ–∏—Ä–æ–≤</div>
                                    </div>
                                `}
                            </div>
                        </div>
                    </div>
                `;
            }

            createVideosPage() {
                return `
                    <div class="page">
                        <div class="detail-header">
                            <button class="back-btn" onclick="app.renderPage('home')">‚Üê –ù–∞–∑–∞–¥</button>
                            <h1>üéØ –í–∏–¥–µ–æ—É—Ä–æ–∫–∏</h1>
                        </div>
                        <div class="empty-state">
                            <div class="empty-icon">üéØ</div>
                            <div class="empty-title">–†–∞–∑–¥–µ–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</div>
                            <div class="empty-description">–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –≤–∏–¥–µ–æ—É—Ä–æ–∫–∏</div>
                        </div>
                    </div>
                `;
            }

            createMaterialsPage() {
                return `
                    <div class="page">
                        <div class="detail-header">
                            <button class="back-btn" onclick="app.renderPage('home')">‚Üê –ù–∞–∑–∞–¥</button>
                            <h1>üìã –ú–∞—Ç–µ—Ä–∏–∞–ª—ã</h1>
                        </div>
                        <div class="empty-state">
                            <div class="empty-icon">üìã</div>
                            <div class="empty-title">–†–∞–∑–¥–µ–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</div>
                            <div class="empty-description">–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –º–∞—Ç–µ—Ä–∏–∞–ª—ã</div>
                        </div>
                    </div>
                `;
            }

            createEventsPage() {
                const events = this.allContent.events || [];
                const upcomingEvents = events.filter(e => new Date(e.event_date) > new Date());
                const pastEvents = events.filter(e => new Date(e.event_date) <= new Date());
                
                return `
                    <div class="page">
                        <div class="detail-header">
                            <button class="back-btn" onclick="app.renderPage('home')">‚Üê –ù–∞–∑–∞–¥</button>
                            <h1>üó∫Ô∏è –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</h1>
                        </div>

                        ${upcomingEvents.length > 0 ? `
                        <div class="upcoming-events-section">
                            <h2 class="section-title">üìÖ –ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</h2>
                            <div class="content-grid">
                                ${upcomingEvents.map(event => this.createEventCard(event)).join('')}
                            </div>
                        </div>
                        ` : ''}
                        
                        <div class="past-events-section">
                            <h2 class="section-title">üìö –ü—Ä–æ—à–µ–¥—à–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</h2>
                            <div class="content-grid">
                                ${pastEvents.length > 0 ? pastEvents.map(event => this.createEventCard(event)).join('') : `
                                    <div class="empty-state">
                                        <div class="empty-icon">üó∫Ô∏è</div>
                                        <div class="empty-title">–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</div>
                                        <div class="empty-description">–°–ª–µ–¥–∏—Ç–µ –∑–∞ –∞–Ω–æ–Ω—Å–∞–º–∏ –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π</div>
                                    </div>
                                `}
                            </div>
                        </div>
                    </div>
                `;
            }

            createFavoritesPage() {
                const favoriteCourses = this.allContent.courses?.filter(course => this.isFavorite(course.id, 'courses')) || [];
                const favoritePodcasts = this.allContent.podcasts?.filter(podcast => this.isFavorite(podcast.id, 'podcasts')) || [];
                const favoriteStreams = this.allContent.streams?.filter(stream => this.isFavorite(stream.id, 'streams')) || [];
                const favoriteEvents = this.allContent.events?.filter(event => this.isFavorite(event.id, 'events')) || [];
                
                const totalFavorites = this.getTotalFavorites();
                
                if (totalFavorites === 0) {
                    return `
                        <div class="page">
                            <div class="detail-header">
                                <button class="back-btn" onclick="app.renderPage('home')">‚Üê –ù–∞–∑–∞–¥</button>
                                <h1>‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h1>
                            </div>
                            <div class="empty-state">
                                <div class="empty-icon">‚ù§Ô∏è</div>
                                <div class="empty-title">–ü–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç</div>
                                <div class="empty-description">–î–æ–±–∞–≤–ª—è–π—Ç–µ –∫—É—Ä—Å—ã, –ø–æ–¥–∫–∞—Å—Ç—ã –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ, —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∏–º –ø–æ–∑–∂–µ</div>
                                <div class="empty-actions">
                                    <button class="btn btn-primary" onclick="app.renderPage('courses')">
                                        üìö –ù–∞–π—Ç–∏ –∫—É—Ä—Å—ã
                                    </button>
                                    <button class="btn btn-outline" onclick="app.renderPage('materials')">
                                        üìã –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                return `
                    <div class="page">
                        <div class="detail-header">
                            <button class="back-btn" onclick="app.renderPage('home')">‚Üê –ù–∞–∑–∞–¥</button>
                            <h1>‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ (${totalFavorites})</h1>
                        </div>

                        ${favoriteCourses.length > 0 ? `
                        <div class="favorites-section">
                            <h2 class="section-title">üìö –ö—É—Ä—Å—ã (${favoriteCourses.length})</h2>
                            <div class="content-grid">
                                ${favoriteCourses.map(course => this.createCourseCard(course)).join('')}
                            </div>
                        </div>
                        ` : ''}

                        ${favoritePodcasts.length > 0 ? `
                        <div class="favorites-section">
                            <h2 class="section-title">üéß –ü–æ–¥–∫–∞—Å—Ç—ã (${favoritePodcasts.length})</h2>
                            <div class="content-grid">
                                ${favoritePodcasts.map(podcast => this.createPodcastCard(podcast)).join('')}
                            </div>
                        </div>
                        ` : ''}

                        ${favoriteStreams.length > 0 ? `
                        <div class="favorites-section">
                            <h2 class="section-title">üìπ –≠—Ñ–∏—Ä—ã (${favoriteStreams.length})</h2>
                            <div class="content-grid">
                                ${favoriteStreams.map(stream => this.createStreamCard(stream)).join('')}
                            </div>
                        </div>
                        ` : ''}

                        ${favoriteEvents.length > 0 ? `
                        <div class="favorites-section">
                            <h2 class="section-title">üó∫Ô∏è –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è (${favoriteEvents.length})</h2>
                            <div class="content-grid">
                                ${favoriteEvents.map(event => this.createEventCard(event)).join('')}
                            </div>
                        </div>
                        ` : ''}
                    </div>
                `;
            }

            createProfilePage() {
                const user = this.currentUser;
                const progress = this.state.progress;
                
                return `
                    <div class="page">
                        <div class="detail-header">
                            <button class="back-btn" onclick="app.renderPage('home')">‚Üê –ù–∞–∑–∞–¥</button>
                            <h1>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h1>
                        </div>

                        <div class="profile-header">
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem;">
                                <div style="width: 80px; height: 80px; background: var(--accent); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem;">
                                    üë®‚Äç‚öïÔ∏è
                                </div>
                                <div>
                                    <h2>${user.firstName} ${user.lastName}</h2>
                                    <p style="color: var(--text-secondary);">–í—Ä–∞—á-–Ω–µ–≤—Ä–æ–ª–æ–≥</p>
                                    <div class="level-badge" style="display: inline-block; margin-top: 0.5rem;">${progress.level}</div>
                                </div>
                            </div>
                        </div>

                        <div class="stats-cards">
                            <div class="stat-card large">
                                <div class="stat-icon">üéØ</div>
                                <div class="stat-content">
                                    <div class="stat-value">${progress.completedCourses || 0}</div>
                                    <div class="stat-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ –∫—É—Ä—Å–æ–≤</div>
                                </div>
                            </div>
                            <div class="stat-card large">
                                <div class="stat-icon">‚è±Ô∏è</div>
                                <div class="stat-content">
                                    <div class="stat-value">${progress.studyHours || 0}</div>
                                    <div class="stat-label">–ß–∞—Å–æ–≤ –æ–±—É—á–µ–Ω–∏—è</div>
                                </div>
                            </div>
                            <div class="stat-card large">
                                <div class="stat-icon">üìà</div>
                                <div class="stat-content">
                                    <div class="stat-value">${progress.experience || 0}</div>
                                    <div class="stat-label">–û–ø—ã—Ç–∞ (XP)</div>
                                </div>
                            </div>
                        </div>

                        <div class="subscription-info-section" style="background: var(--bg-card); padding: 1.5rem; border-radius: 0.75rem; margin: 2rem 0;">
                            <div class="active-subscription">
                                <div class="subscription-plan-info">
                                    <h4>${user.hasActiveSubscription ? '‚úÖ –ê–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞' : '‚ùå –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–µ –∞–∫—Ç–∏–≤–Ω–∞'}</h4>
                                    <p style="color: var(--text-secondary); margin: 0.5rem 0;">
                                        ${user.hasActiveSubscription ? 
                                            `–¢–∞—Ä–∏—Ñ: ${this.userSubscription.plan_name}` : 
                                            '–ü–æ–ª—É—á–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –∫—É—Ä—Å–∞–º –∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º'
                                        }
                                    </p>
                                </div>
                                <button class="btn ${user.hasActiveSubscription ? 'btn-outline' : 'btn-primary'}" 
                                        onclick="app.showSubscriptionModal()">
                                    ${user.hasActiveSubscription ? '–ò–∑–º–µ–Ω–∏—Ç—å' : '–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å'}
                                </button>
                            </div>
                        </div>

                        <div class="action-buttons" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
                            <button class="btn btn-outline action-btn" onclick="app.renderPage('favorites')" style="display: flex; flex-direction: column; align-items: center; gap: 0.5rem; padding: 1rem;">
                                <span style="font-size: 1.5rem;">‚ù§Ô∏è</span>
                                –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
                            </button>
                            <button class="btn btn-outline action-btn" onclick="app.showSettingsModal()" style="display: flex; flex-direction: column; align-items: center; gap: 0.5rem; padding: 1rem;">
                                <span style="font-size: 1.5rem;">‚öôÔ∏è</span>
                                –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                            </button>
                            <button class="btn btn-outline action-btn" onclick="app.showHelp()" style="display: flex; flex-direction: column; align-items: center; gap: 0.5rem; padding: 1rem;">
                                <span style="font-size: 1.5rem;">‚ùì</span>
                                –ü–æ–º–æ—â—å
                            </button>
                            ${this.isAdmin ? `
                            <button class="btn btn-outline action-btn" onclick="app.renderPage('admin')" style="display: flex; flex-direction: column; align-items: center; gap: 0.5rem; padding: 1rem;">
                                <span style="font-size: 1.5rem;">üîß</span>
                                –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
                            </button>
                            ` : ''}
                        </div>
                    </div>
                `;
            }

            createCommunityPage() {
                return `
                    <div class="page">
                        <div class="detail-header">
                            <button class="back-btn" onclick="app.renderPage('home')">‚Üê –ù–∞–∑–∞–¥</button>
                            <h1>üë• –°–æ–æ–±—â–µ—Å—Ç–≤–æ</h1>
                        </div>
                        <div class="empty-state">
                            <div class="empty-icon">üë•</div>
                            <div class="empty-title">–†–∞–∑–¥–µ–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</div>
                            <div class="empty-description">–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ</div>
                        </div>
                    </div>
                `;
            }

            createCartPage() {
                return `
                    <div class="page">
                        <div class="detail-header">
                            <button class="back-btn" onclick="app.renderPage('home')">‚Üê –ù–∞–∑–∞–¥</button>
                            <h1>üõí –ö–æ—Ä–∑–∏–Ω–∞</h1>
                        </div>
                        <div class="empty-state">
                            <div class="empty-icon">üõí</div>
                            <div class="empty-title">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</div>
                            <div class="empty-description">–î–æ–±–∞–≤—å—Ç–µ –∫—É—Ä—Å—ã –∏–ª–∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ –∫–æ—Ä–∑–∏–Ω—É</div>
                        </div>
                    </div>
                `;
            }

            createSearchPage() {
                return `
                    <div class="page">
                        <div class="detail-header">
                            <button class="back-btn" onclick="app.renderPage('home')">‚Üê –ù–∞–∑–∞–¥</button>
                            <h1>üîç –ü–æ–∏—Å–∫</h1>
                        </div>
                        <div class="empty-state">
                            <div class="empty-icon">üîç</div>
                            <div class="empty-title">–ü–æ–∏—Å–∫ –ø–æ –∑–∞–ø—Ä–æ—Å—É: "${this.searchTerm}"</div>
                            <div class="empty-description">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</div>
                        </div>
                    </div>
                `;
            }

            createSettingsPage() {
                return `
                    <div class="page">
                        <div class="detail-header">
                            <button class="back-btn" onclick="app.renderPage('home')">‚Üê –ù–∞–∑–∞–¥</button>
                            <h1>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h1>
                        </div>
                        <div class="empty-state">
                            <div class="empty-icon">‚öôÔ∏è</div>
                            <div class="empty-title">–†–∞–∑–¥–µ–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</div>
                            <div class="empty-description">–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</div>
                        </div>
                    </div>
                `;
            }

            createAdminPage() {
                if (!this.isAdmin) {
                    return this.createAccessDeniedPage();
                }

                return `
                    <div class="page admin-panel">
                        <div class="detail-header">
                            <button class="back-btn" onclick="app.renderPage('home')">‚Üê –ù–∞–∑–∞–¥</button>
                            <h1>üîß –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
                        </div>

                        <div class="admin-stats">
                            <div class="admin-stat">
                                <div class="admin-stat-value">${this.allContent.stats?.totalUsers || 0}</div>
                                <div class="admin-stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                            </div>
                            <div class="admin-stat">
                                <div class="admin-stat-value">${this.allContent.courses?.length || 0}</div>
                                <div class="admin-stat-label">–ö—É—Ä—Å–æ–≤</div>
                            </div>
                            <div class="admin-stat">
                                <div class="admin-stat-value">${this.allContent.podcasts?.length || 0}</div>
                                <div class="admin-stat-label">–ü–æ–¥–∫–∞—Å—Ç–æ–≤</div>
                            </div>
                            <div class="admin-stat">
                                <div class="admin-stat-value">${this.allContent.streams?.length || 0}</div>
                                <div class="admin-stat-label">–≠—Ñ–∏—Ä–æ–≤</div>
                            </div>
                        </div>

                        <div class="admin-tabs">
                            <button class="admin-tab active" onclick="app.switchAdminTab('courses')">–ö—É—Ä—Å—ã</button>
                            <button class="admin-tab" onclick="app.switchAdminTab('users')">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
                            <button class="admin-tab" onclick="app.switchAdminTab('analytics')">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</button>
                        </div>

                        <div class="admin-content">
                            <div id="adminCoursesTab" class="tab-content active">
                                <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞–º–∏</h3>
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                            <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                            <th>–°—Ç—É–¥–µ–Ω—Ç—ã</th>
                                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${this.allContent.courses?.map(course => `
                                            <tr>
                                                <td>${course.id}</td>
                                                <td>${course.title}</td>
                                                <td>${course.category}</td>
                                                <td>${course.students_count}</td>
                                                <td>
                                                    <div class="admin-actions">
                                                        <button class="btn btn-small btn-primary">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                                                        <button class="btn btn-small btn-outline">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                                                    </div>
                                                </td>
                                            </tr>
                                        `).join('') || '<tr><td colspan="5">–ö—É—Ä—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</td></tr>'}
                                    </tbody>
                                </table>
                            </div>
                            <div id="adminUsersTab" class="tab-content">
                                <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h3>
                                <p>–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è</p>
                            </div>
                            <div id="adminAnalyticsTab" class="tab-content">
                                <h3>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</h3>
                                <p>–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è</p>
                            </div>
                        </div>
                    </div>
                `;
            }

            switchAdminTab(tabName) {
                // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
                const targetTab = document.getElementById(`admin${tabName.charAt(0).toUpperCase() + tabName.slice(1)}Tab`);
                if (targetTab) {
                    targetTab.classList.add('active');
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ —Ç–∞–±–æ–≤
                document.querySelectorAll('.admin-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                event.target.classList.add('active');
            }

            createErrorPage(message) {
                return `
                    <div class="empty-state">
                        <div class="empty-icon">‚ö†Ô∏è</div>
                        <div class="empty-title">–û—à–∏–±–∫–∞</div>
                        <div class="empty-description">${message}</div>
                        <button class="btn btn-primary" onclick="app.renderPage('home')" style="margin-top: 1rem;">
                            –ù–∞ –≥–ª–∞–≤–Ω—É—é
                        </button>
                    </div>
                `;
            }

            createNotFoundPage() {
                return `
                    <div class="empty-state">
                        <div class="empty-icon">üîç</div>
                        <div class="empty-title">–°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</div>
                        <div class="empty-description">–ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç</div>
                        <button class="btn btn-primary" onclick="app.renderPage('home')" style="margin-top: 1rem;">
                            –ù–∞ –≥–ª–∞–≤–Ω—É—é
                        </button>
                    </div>
                `;
            }

            createAccessDeniedPage() {
                return `
                    <div class="empty-state">
                        <div class="empty-icon">üö´</div>
                        <div class="empty-title">–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω</div>
                        <div class="empty-description">–£ –≤–∞—Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã</div>
                        <button class="btn btn-primary" onclick="app.renderPage('home')" style="margin-top: 1rem;">
                            –ù–∞ –≥–ª–∞–≤–Ω—É—é
                        </button>
                    </div>
                `;
            }

            // ==================== –î–ï–¢–ê–õ–¨–ù–´–ï –°–¢–†–ê–ù–ò–¶–´ ====================

            createCourseDetailPage(courseId) {
                const course = this.allContent.courses?.find(c => c.id === courseId);
                if (!course) {
                    return this.createNotFoundPage();
                }

                const progress = this.state.progress.courses?.[courseId] || 0;
                const isEnrolled = progress > 0;
                const modules = this.getCourseModules(courseId);

                return `
                    <div class="page">
                        <div class="detail-header">
                            <button class="back-btn" onclick="app.renderPage('courses')">‚Üê –ù–∞–∑–∞–¥</button>
                            <h1>${course.title}</h1>
                        </div>

                        <div class="detail-content">
                            <img src="${course.image_url}" alt="${course.title}" class="detail-image" 
                                 onerror="this.src='https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=600&h=300&fit=crop'">
                            
                            <div class="detail-meta">
                                <div class="detail-meta-item">
                                    <span>üìä ${this.getLevelName(course.level)}</span>
                                </div>
                                <div class="detail-meta-item">
                                    <span>‚è±Ô∏è ${course.duration}</span>
                                </div>
                                <div class="detail-meta-item">
                                    <span>üéØ ${course.modules} –º–æ–¥—É–ª–µ–π</span>
                                </div>
                                <div class="detail-meta-item">
                                    <span>üë• ${course.students_count} —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</span>
                                </div>
                                <div class="detail-meta-item">
                                    <span>‚≠ê ${course.rating}/5</span>
                                </div>
                            </div>

                            <div class="detail-description">
                                ${course.description}
                            </div>

                            ${isEnrolled ? `
                            <div class="progress-section">
                                <div class="progress-header">
                                    <span>–í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å</span>
                                    <span>${progress}%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${progress}%"></div>
                                </div>
                            </div>
                            ` : ''}

                            <div class="detail-actions">
                                ${isEnrolled ? `
                                    <button class="btn btn-success btn-large" onclick="app.continueCourse(${courseId})">
                                        ${progress === 100 ? 'üëÅÔ∏è –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∫—É—Ä—Å' : 'üéØ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ'}
                                    </button>
                                ` : this.currentUser?.hasActiveSubscription ? `
                                    <button class="btn btn-primary btn-large" onclick="app.enrollCourse(${courseId})">
                                        –ù–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ
                                    </button>
                                ` : `
                                    <button class="btn btn-primary btn-large" onclick="app.showSubscriptionModal()">
                                        –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø
                                    </button>
                                `}
                                
                                <button class="favorite-btn ${this.isFavorite(courseId, 'courses') ? 'active' : ''} btn-large" 
                                        onclick="app.toggleFavorite(${courseId}, 'courses')">
                                    ${this.isFavorite(courseId, 'courses') ? '‚ù§Ô∏è' : 'ü§ç'} –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
                                </button>
                            </div>
                        </div>

                        ${modules.length > 0 ? `
                        <div class="modules-section">
                            <h2 class="section-title">üìã –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∫—É—Ä—Å–∞</h2>
                            <div class="module-list">
                                ${modules.map((module, index) => `
                                    <div class="module-item" onclick="app.startModule(${courseId}, ${module.id})">
                                        <div class="module-icon">${index + 1}</div>
                                        <div class="module-content">
                                            <div class="module-title">${module.title}</div>
                                            <div class="module-description">${module.description}</div>
                                        </div>
                                        <div class="module-duration">${module.duration}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}

                        ${course.instructors && course.instructors.length > 0 ? `
                        <div class="instructors-section">
                            <h2 class="section-title">üë®‚Äçüè´ –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏</h2>
                            <div class="content-grid">
                                ${course.instructors.map(instructorId => {
                                    const instructor = this.instructors.find(i => i.id === instructorId);
                                    return instructor ? `
                                        <div class="instructor-card">
                                            <img src="${instructor.avatar_url}" alt="${instructor.name}" class="instructor-avatar"
                                                 onerror="this.src='https://images.unsplash.com/photo-1612349317150-e413f6a5b16d?w=150&h=150&fit=crop'">
                                            <div class="instructor-info">
                                                <div class="instructor-name">${instructor.name}</div>
                                                <div class="instructor-specialization">${instructor.specialization}</div>
                                                <div class="instructor-bio">${instructor.bio}</div>
                                            </div>
                                        </div>
                                    ` : '';
                                }).join('')}
                            </div>
                        </div>
                        ` : ''}
                    </div>
                `;
            }

            getCourseModules(courseId) {
                // –î–µ–º–æ-–º–æ–¥—É–ª–∏ –¥–ª—è –∫—É—Ä—Å–æ–≤
                const modules = {
                    1: [
                        { id: 1, title: '–í–≤–µ–¥–µ–Ω–∏–µ –≤ –º–∞–Ω—É–∞–ª—å–Ω—É—é —Ç–µ—Ä–∞–ø–∏—é', description: '–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∏ —Ç–µ—Ö–Ω–∏–∫–∏', duration: '45 –º–∏–Ω' },
                        { id: 2, title: '–ê–Ω–∞—Ç–æ–º–∏—è –ø–æ–∑–≤–æ–Ω–æ—á–Ω–∏–∫–∞', description: '–°—Ç—Ä–æ–µ–Ω–∏–µ –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∑–≤–æ–Ω–æ—á–Ω–æ–≥–æ —Å—Ç–æ–ª–±–∞', duration: '60 –º–∏–Ω' },
                        { id: 3, title: '–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–π', description: '–ú–µ—Ç–æ–¥—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø–∞—Ç–æ–ª–æ–≥–∏–π –ø–æ–∑–≤–æ–Ω–æ—á–Ω–∏–∫–∞', duration: '75 –º–∏–Ω' }
                    ],
                    2: [
                        { id: 1, title: '–û—Å–Ω–æ–≤—ã –Ω–µ–≤—Ä–æ–ª–æ–≥–∏–∏', description: '–í–≤–µ–¥–µ–Ω–∏–µ –≤ –Ω–µ–≤—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É', duration: '50 –º–∏–Ω' },
                        { id: 2, title: '–ù–µ–≤—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –æ—Å–º–æ—Ç—Ä', description: '–ú–µ—Ç–æ–¥–∏–∫–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –æ—Å–º–æ—Ç—Ä–∞', duration: '65 –º–∏–Ω' }
                    ]
                };
                
                return modules[courseId] || [];
            }

            // ==================== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ====================

            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = 'notification';
                notification.style.background = type === 'error' ? 'var(--error)' : 
                                              type === 'success' ? 'var(--success)' : 
                                              type === 'warning' ? 'var(--warning)' : 'var(--info)';
                
                notification.innerHTML = `
                    <div class="notification-content">
                        <span>${type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è'}</span>
                        <span>${message}</span>
                        <button class="notification-close" onclick="this.parentElement.parentElement.remove()">√ó</button>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    if (notification.parentElement) {
                        notification.remove();
                    }
                }, 3000);
            }

            showFatalError(message) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-container';
                errorDiv.style.display = 'flex';
                errorDiv.innerHTML = `
                    <div class="error-icon">‚ö†Ô∏è</div>
                    <div class="error-title">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>
                    <div class="error-description">${message}</div>
                    <div class="error-actions">
                        <button class="btn btn-primary" onclick="window.location.reload()">
                            üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å
                        </button>
                    </div>
                `;
                
                document.body.innerHTML = '';
                document.body.appendChild(errorDiv);
            }

            // ==================== –ó–ê–ì–õ–£–®–ö–ò –î–õ–Ø –§–£–ù–ö–¶–ò–û–ù–ê–õ–ê ====================

            continueCourse(courseId) {
                this.showNotification('–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∫—É—Ä—Å...', 'info');
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –ø—Ä–æ–π–¥–µ–Ω–Ω–æ–º—É –º–æ–¥—É–ª—é
            }

            enrollCourse(courseId) {
                if (!this.state.progress.courses) {
                    this.state.progress.courses = {};
                }
                this.state.progress.courses[courseId] = 0;
                this.saveState();
                this.showNotification('–í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ –∫—É—Ä—Å!', 'success');
                this.renderPage('courses', `course-${courseId}`);
            }

            startModule(courseId, moduleId) {
                this.showNotification(`–ù–∞—á–∏–Ω–∞–µ–º –º–æ–¥—É–ª—å ${moduleId} –∫—É—Ä—Å–∞ ${courseId}`, 'info');
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é –º–æ–¥—É–ª—è
            }

            registerForEvent(eventId) {
                if (!this.state.progress.events) {
                    this.state.progress.events = {};
                }
                this.state.progress.events[eventId] = { registered: true, attended: false };
                this.saveState();
                this.showNotification('–í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ!', 'success');
                this.renderPage('events');
            }

            cancelEventRegistration(eventId) {
                if (this.state.progress.events && this.state.progress.events[eventId]) {
                    this.state.progress.events[eventId].registered = false;
                    this.saveState();
                    this.showNotification('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞', 'info');
                    this.renderPage('events');
                }
            }

            readNews(newsId) {
                this.showNotification('–ß—Ç–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏...', 'info');
            }

            showHelp() {
                this.showNotification('–†–∞–∑–¥–µ–ª –ø–æ–º–æ—â–∏', 'info');
            }

            switchTab(tabName) {
                this.showNotification(`–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É: ${tabName}`, 'info');
            }

            focusSearch() {
                const searchInput = document.querySelector('.search-input');
                if (searchInput) {
                    searchInput.focus();
                }
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
            
            const loadingScreen = document.getElementById('loadingScreen');
            const errorScreen = document.getElementById('errorScreen');
            const appContainer = document.getElementById('app');
            const retryButton = document.getElementById('retryButton');
            
            async function initializeApp() {
                try {
                    // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    if (typeof AcademyApp === 'undefined') {
                        throw new Error('AcademyApp class not found');
                    }
                    
                    window.app = new AcademyApp();
                    await window.app.init();
                    
                    if (loadingScreen) loadingScreen.style.display = 'none';
                    if (errorScreen) errorScreen.style.display = 'none';
                    if (appContainer) appContainer.style.display = 'block';
                    
                    console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
                    
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                    
                    if (loadingScreen) loadingScreen.style.display = 'none';
                    if (errorScreen) {
                        errorScreen.style.display = 'flex';
                        const errorMessage = document.getElementById('errorMessage');
                        if (errorMessage) {
                            errorMessage.textContent = error.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ';
                        }
                    }
                }
            }
            
            if (retryButton) {
                retryButton.addEventListener('click', function() {
                    if (errorScreen) errorScreen.style.display = 'none';
                    if (loadingScreen) loadingScreen.style.display = 'flex';
                    setTimeout(initializeApp, 500);
                });
            }
            
            initializeApp();
        });
    </script>
</body>
</html>
