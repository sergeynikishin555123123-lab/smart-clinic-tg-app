<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–∫–∞–¥–µ–º–∏—è –ê–ù–ë</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app">
        <header class="header">
            <h1>–ê–∫–∞–¥–µ–º–∏—è –ê–ù–ë</h1>
            <div class="admin-badge" id="adminBadge" style="display: none;">üîß –ê–¥–º–∏–Ω</div>
        </header>

        <main class="main" id="mainContent">
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è JavaScript -->
        </main>

        <nav class="nav">
            <button class="nav-btn active" data-page="home">üè† –î–æ–º–æ–π</button>
            <button class="nav-btn" data-page="community">üë• –°–æ–æ–±—â–µ—Å—Ç–≤–æ</button>
            <button class="nav-btn" data-page="chats">üí¨ –ß–∞—Ç—ã</button>
            <button class="nav-btn" data-page="materials">üìö –ú–∞—Ç–µ—Ä–∏–∞–ª—ã</button>
            <button class="nav-btn" data-page="profile">üë§ –ü—Ä–æ—Ñ–∏–ª—å</button>
        </nav>
    </div>

    <script>
        // ==================== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –°–¢–†–ê–ù–ò–¶ ====================
        const pages = {
            home: {
                title: '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ê–∫–∞–¥–µ–º–∏—é –ê–ù–ë!',
                content: `
                    <div class="search">
                        <input type="text" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫—É—Ä—Å–∞–º, –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º, —ç—Ñ–∏—Ä–∞–º..." class="search-input" id="searchInput">
                    </div>
                    
                    <div class="grid">
                        <div class="card" onclick="openSection('courses')">üìö –ö—É—Ä—Å—ã</div>
                        <div class="card" onclick="openSection('fm')">üéß –ê–ù–ë FM</div>
                        <div class="card" onclick="openSection('streams')">üìπ –≠—Ñ–∏—Ä—ã|–†–∞–∑–±–æ—Ä—ã</div>
                        <div class="card" onclick="openSection('cheats')">üéØ –í–∏–¥–µ–æ-—à–ø–∞—Ä–≥–∞–ª–∫–∏</div>
                        <div class="card" onclick="openSection('practice')">üìã –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</div>
                        <div class="card" onclick="openSection('events')">üó∫Ô∏è –ö–∞—Ä—Ç–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π</div>
                        <div class="card" onclick="openSection('offers')">üî• –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</div>
                        <div class="card" onclick="openSection('support')">üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞</div>
                    </div>

                    <div class="news">
                        <h3>üì∞ –õ–µ–Ω—Ç–∞ –Ω–æ–≤–æ—Å—Ç–µ–π</h3>
                        <div class="filters" id="newsFilters">
                            <button class="filter active" data-filter="all">–í—Å–µ</button>
                            <button class="filter" data-filter="articles">–°—Ç–∞—Ç—å–∏</button>
                            <button class="filter" data-filter="development">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ</button>
                            <button class="filter" data-filter="skills">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏</button>
                        </div>
                        <div class="news-list" id="newsList">
                            <div class="news-item">
                                <strong>–ù–æ–≤—ã–π –∫—É—Ä—Å: "–ú–∞–Ω—É–∞–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –≤ –ø—Ä–∞–∫—Ç–∏–∫–µ"</strong>
                                <p>–î–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –≤—Å–µ—Ö –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ —Å 1 –¥–µ–∫–∞–±—Ä—è ‚Ä¢ 6 –º–æ–¥—É–ª–µ–π</p>
                            </div>
                            <div class="news-item">
                                <strong>–í–µ–±–∏–Ω–∞—Ä –ø–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –º–µ—Ç–æ–¥–∞–º —Ä–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏–∏</strong>
                                <p>28 –Ω–æ—è–±—Ä—è –≤ 19:00 ‚Ä¢ –°–ø–∏–∫–µ—Ä: –ò–ª—å—è –ß–∏—Å—Ç—è–∫–æ–≤</p>
                            </div>
                        </div>
                    </div>
                `
            },
            community: {
                title: '–û —Å–æ–æ–±—â–µ—Å—Ç–≤–µ',
                content: `
                    <div class="grid">
                        <div class="card" onclick="openSection('rules')">üìú –ü—Ä–∞–≤–∏–ª–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</div>
                        <div class="card" onclick="openSection('faq')">‚ùì F.A.Q.</div>
                        <div class="card" onclick="openSection('subscription')">üí≥ –ü–æ–¥–ø–∏—Å–∫–∞</div>
                        <div class="card" onclick="openSection('howto')">üîÑ –ö–∞–∫ –æ—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É</div>
                    </div>
                    
                    <div class="faq">
                        <h3>–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h3>
                        
                        <div class="faq-item">
                            <strong>–ö–∞–∫ –æ—Ñ–æ—Ä–º–∏—Ç—å, –ø—Ä–æ–¥–ª–∏—Ç—å –∏–ª–∏ –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É?</strong>
                            <p>–ü–æ–¥–ø–∏—Å–∫—É –º–æ–∂–Ω–æ –æ—Ñ–æ—Ä–º–∏—Ç—å –∏–ª–∏ –ø—Ä–æ–¥–ª–∏—Ç—å –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç¬ª. –¢–∞–º –∂–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –æ—Ç–º–µ–Ω–∞ ‚Äî —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É ¬´–ò–∑–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É¬ª.</p>
                        </div>
                        
                        <div class="faq-item">
                            <strong>–ß—Ç–æ –≤—Ö–æ–¥–∏—Ç –≤ –ø–æ–¥–ø–∏—Å–∫—É –ê–∫–∞–¥–µ–º–∏–∏?</strong>
                            <p>–î–æ—Å—Ç—É–ø –∫ —ç—Ñ–∏—Ä–∞–º, —Ä–∞–∑–±–æ—Ä–∞–º, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º, –≤–∏–¥–µ–æ-—à–ø–∞—Ä–≥–∞–ª–∫–∞–º, —á–∞—Ç—É —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –∏ –∫–∞—Ä—Ç–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π.</p>
                        </div>
                    </div>
                `
            },
            profile: {
                title: '–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç',
                content: `
                    <div class="profile-header">
                        <div class="avatar">üë§</div>
                        <div class="profile-info">
                            <div class="name" id="userName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                            <div class="status">–ß–ª–µ–Ω –ê–∫–∞–¥–µ–º–∏–∏ –ê–ù–ë —Å <span id="joinDate">–Ω–æ—è–±—Ä—è 2024</span></div>
                            <div class="subscription" id="subscriptionStatus">–ü–æ–¥–ø–∏—Å–∫–∞: –Ω–µ –∞–∫—Ç–∏–≤–Ω–∞</div>
                            <button class="btn" onclick="changeSubscription()">–ò–∑–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É</button>
                        </div>
                    </div>

                    <div class="journey">
                        <h3>üéØ –ú–æ–π –ø—É—Ç—å —Ä–∞–∑–≤–∏—Ç–∏—è</h3>
                        <div class="journey-steps">
                            <div class="step active">
                                <div class="step-number">1Ô∏è‚É£</div>
                                <div class="step-info">
                                    <div class="step-title">–ü–æ–Ω–∏–º–∞—é</div>
                                    <div class="step-progress">–ü—Ä–æ–≥—Ä–µ—Å—Å: 100%</div>
                                    <div class="step-hint">–ù–∞—á–∏–Ω–∞—é –∑–∞–º–µ—á–∞—Ç—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –∏ —Å–≤—è–∑–∏</div>
                                </div>
                            </div>
                            <div class="step">
                                <div class="step-number">2Ô∏è‚É£</div>
                                <div class="step-info">
                                    <div class="step-title">–°–≤—è–∑—ã–≤–∞—é</div>
                                    <div class="step-progress">–ü—Ä–æ–≥—Ä–µ—Å—Å: 60%</div>
                                    <div class="step-hint">–ó–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ —Å–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –≤ –µ–¥–∏–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">üìö</div>
                            <div class="stat-title">–ü—Ä–æ–π–¥–µ–Ω–æ –∫—É—Ä—Å–æ–≤</div>
                            <div class="stat-value">2</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üéØ</div>
                            <div class="stat-title">–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</div>
                            <div class="stat-value">15</div>
                        </div>
                    </div>
                `
            },
            chats: {
                title: '–ß–∞—Ç—ã —Å–æ–æ–±—â–µ—Å—Ç–≤–∞',
                content: `
                    <div class="chats-list">
                        <div class="chat-item" onclick="openChat('general')">
                            <div class="chat-icon">üí¨</div>
                            <div class="chat-info">
                                <div class="chat-name">–§–ª—É–¥–∏–ª–∫–∞</div>
                                <div class="chat-desc">–û–±—â–µ–Ω–∏–µ –Ω–∞ –ª—é–±—ã–µ —Ç–µ–º—ã</div>
                            </div>
                        </div>
                        <div class="chat-item" onclick="openChat('specialists')">
                            <div class="chat-icon">üë•</div>
                            <div class="chat-info">
                                <div class="chat-name">–ß–∞—Ç —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤</div>
                                <div class="chat-desc">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è</div>
                            </div>
                        </div>
                    </div>
                    <div class="note">
                        üìù –ß–∞—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–æ–π
                    </div>
                `
            },
            materials: {
                title: '–ú–æ–∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã',
                content: `
                    <div class="tabs">
                        <button class="tab active" onclick="switchTab('watch-later')">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ</button>
                        <button class="tab" onclick="switchTab('favorites')">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</button>
                        <button class="tab" onclick="switchTab('practice')">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</button>
                    </div>
                    
                    <div class="tab-content active" id="watch-later">
                        <div class="materials-list">
                            <div class="material-item">
                                <div class="material-icon">üìπ</div>
                                <div class="material-info">
                                    <div class="material-title">–†–∞–∑–±–æ—Ä –∫–ª–∏–Ω–∏—á–µ—Å–∫–æ–≥–æ —Å–ª—É—á–∞—è: –ë–æ–ª—å –≤ –ø–æ—è—Å–Ω–∏—Ü–µ</div>
                                    <div class="material-date">–î–æ–±–∞–≤–ª–µ–Ω–æ 2 –¥–Ω—è –Ω–∞–∑–∞–¥ ‚Ä¢ 45:24</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="favorites">
                        <div class="materials-list">
                            <div class="material-item">
                                <div class="material-icon">üéØ</div>
                                <div class="material-info">
                                    <div class="material-title">–í–∏–¥–µ–æ-—à–ø–∞—Ä–≥–∞–ª–∫–∞: –¢–µ—Ö–Ω–∏–∫–∞ –º–∏–æ—Ñ–∞—Å—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Ä–µ–ª–∏–∑–∞</div>
                                    <div class="material-date">–í –∏–∑–±—Ä–∞–Ω–Ω–æ–º ‚Ä¢ 08:15</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="practice">
                        <div class="materials-grid">
                            <div class="card" onclick="openSection('mri')">
                                <div class="card-icon">ü©ª</div>
                                <div>–ú–†–¢ —Ä–∞–∑–±–æ—Ä—ã</div>
                            </div>
                            <div class="card" onclick="openSection('cases')">
                                <div class="card-icon">üìã</div>
                                <div>–ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ —Å–ª—É—á–∞–∏</div>
                            </div>
                            <div class="card" onclick="openSection('checklists')">
                                <div class="card-icon">‚úÖ</div>
                                <div>–ß–µ–∫-–ª–∏—Å—Ç—ã</div>
                            </div>
                        </div>
                    </div>
                `
            }
        };

        // ==================== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
        let currentPage = 'home';
        let currentUser = null;

        function renderPage(page) {
            currentPage = page;
            const pageData = pages[page];
            
            document.getElementById('mainContent').innerHTML = `
                <div class="page">
                    <h2>${pageData.title}</h2>
                    ${pageData.content}
                </div>
            `;

            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.page === page);
            });

            console.log('‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞:', page);
        }

        function openSection(section) {
            const sections = {
                'courses': 'üìö –ö—É—Ä—Å—ã',
                'fm': 'üéß –ê–ù–ë FM', 
                'streams': 'üìπ –≠—Ñ–∏—Ä—ã –∏ –†–∞–∑–±–æ—Ä—ã',
                'cheats': 'üéØ –í–∏–¥–µ–æ-—à–ø–∞—Ä–≥–∞–ª–∫–∏'
            };
            
            alert(`üéØ –û—Ç–∫—Ä—ã–≤–∞–µ–º: ${sections[section] || section}\n\n–†–∞–∑–¥–µ–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!`);
        }

        function openChat(chatId) {
            alert(`üí¨ ${chatId === 'general' ? '–§–ª—É–¥–∏–ª–∫–∞' : '–ß–∞—Ç —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤'}\n\n–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –Ω—É–∂–Ω–∞ –∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞.`);
        }

        function changeSubscription() {
            alert(`üí≥ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π\n\n–¢–µ–∫—É—â–∏–π —Ç–∞—Ä–∏—Ñ: ${currentUser?.subscription?.status === 'trial' ? '–ü—Ä–æ–±–Ω—ã–π' : '–ù–µ –∞–∫—Ç–∏–≤–µ–Ω'}\n\n–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—É.`);
        }

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            const targetTab = document.getElementById(tabId);
            if (targetTab) {
                targetTab.classList.add('active');
            }
            event.target.classList.add('active');
        }

        // ==================== –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° –ë–û–¢–û–ú ====================
        async function loadUserData() {
            try {
                if (window.Telegram && Telegram.WebApp) {
                    const tgUser = Telegram.WebApp.initDataUnsafe.user;
                    if (tgUser && tgUser.id) {
                        const response = await fetch(`/api/user/${tgUser.id}`);
                        const data = await response.json();
                        
                        if (data.success) {
                            currentUser = data.user;
                            updateUIWithUserData();
                        }
                    }
                }
            } catch (error) {
                console.log('‚ÑπÔ∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ Telegram');
                if (window.Telegram && Telegram.WebApp) {
                    const tgUser = Telegram.WebApp.initDataUnsafe.user;
                    if (tgUser) {
                        currentUser = {
                            firstName: tgUser.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                            subscription: { status: 'inactive' }
                        };
                        updateUIWithUserData();
                    }
                }
            }
        }

        function updateUIWithUserData() {
            if (!currentUser) return;
            
            const userNameElement = document.getElementById('userName');
            const subscriptionStatusElement = document.getElementById('subscriptionStatus');
            
            if (userNameElement) {
                userNameElement.textContent = currentUser.firstName;
            }
            
            if (subscriptionStatusElement) {
                let statusText = '–ü–æ–¥–ø–∏—Å–∫–∞: –Ω–µ –∞–∫—Ç–∏–≤–Ω–∞';
                let statusClass = 'inactive';
                
                if (currentUser.subscription.status === 'trial') {
                    statusText = '–ü–æ–¥–ø–∏—Å–∫–∞: –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥';
                    statusClass = 'active';
                }
                
                subscriptionStatusElement.textContent = statusText;
                subscriptionStatusElement.className = `subscription ${statusClass}`;
            }
            
            if (currentUser.id === 898508164) {
                document.getElementById('adminBadge').style.display = 'block';
            }
        }

        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    renderPage(this.dataset.page);
                });
            });

            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('filter')) {
                    document.querySelectorAll('.filter').forEach(f => f.classList.remove('active'));
                    e.target.classList.add('active');
                }
            });

            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', function(e) {
                    console.log('–ü–æ–∏—Å–∫:', e.target.value);
                });
            }

            renderPage('home');
            loadUserData();

            if (window.Telegram && Telegram.WebApp) {
                Telegram.WebApp.expand();
                Telegram.WebApp.ready();
            }

            console.log('‚úÖ WebApp –∑–∞–≥—Ä—É–∂–µ–Ω!');
        });
    </script>
</body>
</html>
