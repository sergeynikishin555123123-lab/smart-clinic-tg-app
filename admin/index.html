<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –ê–∫–∞–¥–µ–º–∏–∏ –ê–ù–ë</title>
    <style>
        /* –í—Å–µ CSS —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–æ—á–Ω–æ —Ç–∞–∫–∏–º–∏ –∂–µ –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-card: #1e293b;
            --text-primary: #ffffff;
            --text-secondary: #94a3b8;
            --accent: #3b82f6;
            --accent-hover: #2563eb;
            --border: #334155;
            --success: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .admin-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .admin-header {
            background: var(--bg-secondary);
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-header h1 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.25rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .admin-nav {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            overflow-x: auto;
            position: sticky;
            top: 73px;
            z-index: 99;
        }

        .admin-nav ul {
            display: flex;
            gap: 0.5rem;
            list-style: none;
            padding: 1rem;
            min-width: max-content;
        }

        .admin-nav a {
            color: var(--text-secondary);
            text-decoration: none;
            padding: 0.75rem 1rem;
            border-radius: 0.375rem;
            transition: all 0.3s;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .admin-nav a:hover,
        .admin-nav a.active {
            background: var(--accent);
            color: white;
        }

        .admin-main {
            flex: 1;
            padding: 1rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-card);
            padding: 1.5rem;
            border-radius: 0.5rem;
            border: 1px solid var(--border);
            text-align: center;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .content-section {
            background: var(--bg-card);
            border-radius: 0.5rem;
            border: 1px solid var(--border);
            margin-bottom: 1.5rem;
            overflow: hidden;
        }

        .section-header {
            padding: 1.25rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .section-header h2 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.1rem;
        }

        .section-content {
            padding: 1.25rem;
            overflow-x: auto;
        }

        .content-actions {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.75rem 1.25rem;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            white-space: nowrap;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-hover);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-danger {
            background: var(--error);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-primary);
        }

        .btn-outline:hover {
            background: var(--bg-secondary);
        }

        .btn-small {
            padding: 0.5rem 0.75rem;
            font-size: 0.75rem;
        }

        .content-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }

        .content-table th,
        .content-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .content-table th {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 0.875rem;
        }

        .content-table tr:hover {
            background: var(--bg-secondary);
        }

        .status-active {
            color: var(--success);
        }

        .status-inactive {
            color: var(--error);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            padding: 1rem;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            align-items: flex-start;
            justify-content: center;
        }

        .modal-content {
            background: var(--bg-card);
            border-radius: 0.5rem;
            border: 1px solid var(--border);
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            margin-top: 2rem;
        }

        .modal-header {
            padding: 1.25rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-body {
            padding: 1.25rem;
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 0.375rem;
            color: var(--text-primary);
            font-size: 1rem;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--accent);
        }

        textarea.form-control {
            resize: vertical;
            min-height: 100px;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .spinner {
            width: 2rem;
            height: 2rem;
            border: 2px solid var(--border);
            border-top: 2px solid var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            background: #7f1d1d;
            color: #fecaca;
            padding: 1rem;
            border-radius: 0.375rem;
            margin-bottom: 1rem;
        }

        .success-message {
            background: #065f46;
            color: #a7f3d0;
            padding: 1rem;
            border-radius: 0.375rem;
            margin-bottom: 1rem;
        }

        .user-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .badge-admin {
            background: var(--accent);
            color: white;
        }

        .badge-super-admin {
            background: var(--warning);
            color: white;
        }

        .badge-user {
            background: var(--border);
            color: var(--text-secondary);
        }

        .user-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .role-select {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 0.375rem;
            color: var(--text-primary);
            padding: 0.5rem;
            font-size: 0.875rem;
        }

        .instructors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
        }

        .instructor-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            padding: 1.5rem;
            transition: all 0.3s;
        }

        .instructor-card:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .instructor-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .instructor-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
            background: var(--bg-primary);
        }

        .instructor-info h3 {
            margin-bottom: 0.25rem;
        }

        .instructor-specialization {
            color: var(--accent);
            font-size: 0.875rem;
        }

        .instructor-bio {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .instructor-stats {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .instructor-stat {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .navigation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
        }

        .navigation-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            padding: 1.5rem;
            transition: all 0.3s;
        }

        .navigation-card:hover {
            border-color: var(--accent);
        }

        .media-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }

        .media-item {
            background: var(--bg-secondary);
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            border: 1px solid var(--border);
        }

        @media (max-width: 768px) {
            .admin-main {
                padding: 0.75rem;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .section-header {
                padding: 1rem;
                flex-direction: column;
                align-items: flex-start;
            }

            .section-content {
                padding: 1rem;
            }

            .content-actions {
                flex-direction: column;
            }

            .content-actions .btn {
                width: 100%;
                justify-content: center;
            }

            .form-actions {
                flex-direction: column;
            }

            .form-actions .btn {
                width: 100%;
                justify-content: center;
            }

            .modal-content {
                margin-top: 1rem;
            }

            .instructors-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .admin-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }

            .admin-header h1 {
                font-size: 1.1rem;
            }

            .admin-nav ul {
                padding: 0.75rem;
            }

            .admin-nav a {
                padding: 0.6rem 0.8rem;
                font-size: 0.875rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .stat-card {
                padding: 1rem;
            }

            .stat-value {
                font-size: 1.5rem;
            }

            .content-table {
                min-width: 300px;
            }

            .content-table th,
            .content-table td {
                padding: 0.75rem 0.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <header class="admin-header">
            <h1>üîß –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –ê–∫–∞–¥–µ–º–∏–∏ –ê–ù–ë</h1>
            <div class="user-info">
                <span>üë§ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</span>
                <button class="btn btn-outline btn-small" onclick="logout()">üö™ –í—ã–π—Ç–∏</button>
            </div>
        </header>

        <nav class="admin-nav">
            <ul>
                <li><a href="#" class="active" onclick="showTab('dashboard')">üìä –î–∞—à–±–æ—Ä–¥</a></li>
                <li><a href="#" onclick="showTab('courses')">üìö –ö—É—Ä—Å—ã</a></li>
                <li><a href="#" onclick="showTab('podcasts')">üéß –ü–æ–¥–∫–∞—Å—Ç—ã</a></li>
                <li><a href="#" onclick="showTab('videos')">üéØ –í–∏–¥–µ–æ</a></li>
                <li><a href="#" onclick="showTab('materials')">üìã –ú–∞—Ç–µ—Ä–∏–∞–ª—ã</a></li>
                <li><a href="#" onclick="showTab('instructors')">üë®‚Äçüè´ –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏</a></li>
                <li><a href="#" onclick="showTab('users')">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a></li>
                <li><a href="#" onclick="showTab('media')">üìÅ –ú–µ–¥–∏–∞</a></li>
                <li><a href="#" onclick="showTab('settings')">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a></li>
                <li><a href="#" onclick="showTab('navigation')">üß≠ –ù–∞–≤–∏–≥–∞—Ü–∏—è</a></li>
            </ul>
        </nav>

        <main class="admin-main">
            <!-- –î–∞—à–±–æ—Ä–¥ -->
            <div id="dashboard-tab" class="tab-content active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="total-users">0</div>
                        <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-courses">0</div>
                        <div class="stat-label">–ö—É—Ä—Å–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-materials">0</div>
                        <div class="stat-label">–ú–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="active-subscriptions">0</div>
                        <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫</div>
                    </div>
                </div>

                <div class="content-section">
                    <div class="section-header">
                        <h2>üìà –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
                    </div>
                    <div class="section-content">
                        <div class="content-actions">
                            <button class="btn btn-primary" onclick="showAddModal('courses')">
                                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫—É—Ä—Å
                            </button>
                            <button class="btn btn-primary" onclick="showAddModal('podcasts')">
                                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∫–∞—Å—Ç
                            </button>
                            <button class="btn btn-primary" onclick="showAddModal('videos')">
                                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –≤–∏–¥–µ–æ
                            </button>
                            <button class="btn btn-primary" onclick="showAddModal('materials')">
                                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª
                            </button>
                            <button class="btn btn-primary" onclick="showAddModal('instructors')">
                                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
                            </button>
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <div class="section-header">
                        <h2>üìä –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h2>
                    </div>
                    <div class="section-content">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div>
                                <h4 style="margin-bottom: 1rem;">–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</h4>
                                <div id="recent-users" style="display: flex; flex-direction: column; gap: 0.5rem;">
                                    <div class="loading">
                                        <div class="spinner"></div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 style="margin-bottom: 1rem;">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫—É—Ä—Å—ã</h4>
                                <div id="popular-courses" style="display: flex; flex-direction: column; gap: 0.5rem;">
                                    <div class="loading">
                                        <div class="spinner"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ö—É—Ä—Å—ã -->
            <div id="courses-tab" class="tab-content">
                <div class="content-section">
                    <div class="section-header">
                        <h2>üìö –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞–º–∏</h2>
                        <button class="btn btn-primary" onclick="showAddModal('courses')">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫—É—Ä—Å
                        </button>
                    </div>
                    <div class="section-content">
                        <div class="content-actions">
                            <input type="text" id="courses-search" class="form-control" placeholder="üîç –ü–æ–∏—Å–∫ –∫—É—Ä—Å–æ–≤..." style="max-width: 300px;" onkeyup="filterCourses()">
                            <select id="courses-category" class="form-control" style="max-width: 200px;" onchange="filterCourses()">
                                <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                            </select>
                            <select id="courses-status" class="form-control" style="max-width: 200px;" onchange="filterCourses()">
                                <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                                <option value="active">–ê–∫—Ç–∏–≤–Ω—ã–µ</option>
                                <option value="inactive">–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ</option>
                            </select>
                        </div>
                        <div class="loading" id="courses-loading">
                            <div class="spinner"></div>
                        </div>
                        <table class="content-table" id="courses-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                    <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                    <th>–¶–µ–Ω–∞</th>
                                    <th>–°—Ç—É–¥–µ–Ω—Ç—ã</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="courses-tbody">
                                <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- –ü–æ–¥–∫–∞—Å—Ç—ã -->
            <div id="podcasts-tab" class="tab-content">
                <div class="content-section">
                    <div class="section-header">
                        <h2>üéß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–∞—Å—Ç–∞–º–∏</h2>
                        <button class="btn btn-primary" onclick="showAddModal('podcasts')">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∫–∞—Å—Ç
                        </button>
                    </div>
                    <div class="section-content">
                        <div class="loading" id="podcasts-loading">
                            <div class="spinner"></div>
                        </div>
                        <table class="content-table" id="podcasts-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                    <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                    <th>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
                                    <th>–ü—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="podcasts-tbody">
                                <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- –í–∏–¥–µ–æ -->
            <div id="videos-tab" class="tab-content">
                <div class="content-section">
                    <div class="section-header">
                        <h2>üéØ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ</h2>
                        <button class="btn btn-primary" onclick="showAddModal('videos')">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –≤–∏–¥–µ–æ
                        </button>
                    </div>
                    <div class="section-content">
                        <div class="loading" id="videos-loading">
                            <div class="spinner"></div>
                        </div>
                        <table class="content-table" id="videos-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                    <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                    <th>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
                                    <th>–ü—Ä–æ—Å–º–æ—Ç—Ä—ã</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="videos-tbody">
                                <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- –ú–∞—Ç–µ—Ä–∏–∞–ª—ã -->
            <div id="materials-tab" class="tab-content">
                <div class="content-section">
                    <div class="section-header">
                        <h2>üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏</h2>
                        <button class="btn btn-primary" onclick="showAddModal('materials')">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª
                        </button>
                    </div>
                    <div class="section-content">
                        <div class="loading" id="materials-loading">
                            <div class="spinner"></div>
                        </div>
                        <table class="content-table" id="materials-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                    <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                    <th>–¢–∏–ø</th>
                                    <th>–ó–∞–≥—Ä—É–∑–∫–∏</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="materials-tbody">
                                <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏ -->
            <div id="instructors-tab" class="tab-content">
                <div class="content-section">
                    <div class="section-header">
                        <h2>üë®‚Äçüè´ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è–º–∏</h2>
                        <button class="btn btn-primary" onclick="showAddModal('instructors')">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
                        </button>
                    </div>
                    <div class="section-content">
                        <div class="loading" id="instructors-loading">
                            <div class="spinner"></div>
                        </div>
                        <div class="instructors-grid" id="instructors-grid">
                            <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ -->
            <div id="users-tab" class="tab-content">
                <div class="content-section">
                    <div class="section-header">
                        <h2>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h2>
                    </div>
                    <div class="section-content">
                        <div class="content-actions">
                            <input type="text" id="users-search" class="form-control" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π..." style="max-width: 300px;" onkeyup="filterUsers()">
                            <select id="users-role" class="form-control" style="max-width: 200px;" onchange="filterUsers()">
                                <option value="">–í—Å–µ —Ä–æ–ª–∏</option>
                                <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                                <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                                <option value="super_admin">–°—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                            </select>
                        </div>
                        <div class="loading" id="users-loading">
                            <div class="spinner"></div>
                        </div>
                        <table class="content-table" id="users-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>–ò–º—è</th>
                                    <th>Username</th>
                                    <th>–†–æ–ª—å</th>
                                    <th>–ü–æ–¥–ø–∏—Å–∫–∞</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="users-tbody">
                                <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- –ú–µ–¥–∏–∞ -->
            <div id="media-tab" class="tab-content">
                <div class="content-section">
                    <div class="section-header">
                        <h2>üìÅ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ–¥–∏–∞</h2>
                        <button class="btn btn-primary" onclick="showMediaUploadModal()">
                            üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª
                        </button>
                    </div>
                    <div class="section-content">
                        <div class="content-actions">
                            <input type="text" id="media-search" class="form-control" placeholder="üîç –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤..." style="max-width: 300px;" onkeyup="filterMedia()">
                            <select id="media-type" class="form-control" style="max-width: 200px;" onchange="filterMedia()">
                                <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                                <option value="image">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</option>
                                <option value="video">–í–∏–¥–µ–æ</option>
                                <option value="audio">–ê—É–¥–∏–æ</option>
                                <option value="document">–î–æ–∫—É–º–µ–Ω—Ç—ã</option>
                            </select>
                        </div>
                        <div class="loading" id="media-loading">
                            <div class="spinner"></div>
                        </div>
                        <div class="media-grid" id="media-grid">
                            <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
            <div id="settings-tab" class="tab-content">
                <div class="content-section">
                    <div class="section-header">
                        <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã</h2>
                    </div>
                    <div class="section-content">
                        <form id="settings-form">
                            <div class="form-group">
                                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∞–∫–∞–¥–µ–º–∏–∏</label>
                                <input type="text" class="form-control" value="–ê–∫–∞–¥–µ–º–∏—è –ê–ù–ë">
                            </div>
                            <div class="form-group">
                                <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                                <textarea class="form-control" rows="3">–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—Ä–∞—á–µ–π</textarea>
                            </div>
                            <div class="form-group">
                                <label>–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π email</label>
                                <input type="email" class="form-control" value="info@academy.ru">
                            </div>
                            <div class="form-group">
                                <label>–¢–µ–ª–µ—Ñ–æ–Ω –ø–æ–¥–¥–µ—Ä–∂–∫–∏</label>
                                <input type="tel" class="form-control" value="+7 (999) 123-45-67">
                            </div>
                            <div class="form-group">
                                <label>–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏</label>
                                <input type="text" class="form-control" value="–ü–Ω-–ü—Ç: 9:00-18:00">
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-outline" onclick="resetSettings()">–°–±—Ä–æ—Å–∏—Ç—å</button>
                                <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
            <div id="navigation-tab" class="tab-content">
                <div class="content-section">
                    <div class="section-header">
                        <h2>üß≠ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π</h2>
                        <button class="btn btn-primary" onclick="showAddNavigationModal()">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É
                        </button>
                    </div>
                    <div class="section-content">
                        <div class="loading" id="navigation-loading">
                            <div class="spinner"></div>
                        </div>
                        <div class="navigation-grid" id="navigation-grid">
                            <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ -->
    <div id="add-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç</h3>
                <button class="modal-close" onclick="closeModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="content-form" enctype="multipart/form-data">
                    <input type="hidden" id="content-type" name="contentType">
                    <input type="hidden" id="content-id" name="id">
                    
                    <div class="form-group">
                        <label for="title">–ù–∞–∑–≤–∞–Ω–∏–µ *</label>
                        <input type="text" id="title" name="title" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="description">–û–ø–∏—Å–∞–Ω–∏–µ *</label>
                        <textarea id="description" name="description" class="form-control" rows="3" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                        <select id="category" name="category_id" class="form-control" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                        </select>
                    </div>
                    
                    <div id="course-fields" style="display: none;">
                        <div class="form-group">
                            <label for="price">–¶–µ–Ω–∞ (‚ÇΩ) *</label>
                            <input type="number" id="price" name="price" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="discount">–°–∫–∏–¥–∫–∞ (%)</label>
                            <input type="number" id="discount" name="discount" class="form-control" min="0" max="100">
                        </div>
                        <div class="form-group">
                            <label for="duration">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å *</label>
                            <input type="text" id="duration" name="duration" class="form-control" placeholder="12 –Ω–µ–¥–µ–ª—å" required>
                        </div>
                        <div class="form-group">
                            <label for="modules">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–¥—É–ª–µ–π *</label>
                            <input type="number" id="modules" name="modules_count" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="level">–£—Ä–æ–≤–µ–Ω—å *</label>
                            <select id="level" name="level" class="form-control" required>
                                <option value="beginner">–ù–∞—á–∏–Ω–∞—é—â–∏–π</option>
                                <option value="intermediate">–°—Ä–µ–¥–Ω–∏–π</option>
                                <option value="advanced">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</option>
                            </select>
                        </div>
                    </div>

                    <div id="instructor-fields" style="display: none;">
                        <div class="form-group">
                            <label for="specialization">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è *</label>
                            <input type="text" id="specialization" name="specialization" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="bio">–ë–∏–æ–≥—Ä–∞—Ñ–∏—è *</label>
                            <textarea id="bio" name="bio" class="form-control" rows="4" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="experience_years">–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã (–ª–µ—Ç) *</label>
                            <input type="number" id="experience_years" name="experience_years" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="instructor_email">Email</label>
                            <input type="email" id="instructor_email" name="email" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="social_links">–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ (JSON)</label>
                            <textarea id="social_links" name="social_links" class="form-control" rows="3" placeholder='{"telegram": "@username", "instagram": "@username"}'></textarea>
                        </div>
                    </div>
                    
                    <div id="media-fields">
                        <div class="form-group">
                            <label for="image_url">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                            <input type="url" id="image_url" name="image_url" class="form-control">
                        </div>
                        
                        <div class="form-group">
                            <label for="file">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</label>
                            <input type="file" id="file" name="file" class="form-control">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="is_published" name="is_published">
                            –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å—Ä–∞–∑—É
                        </label>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-outline" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
                        <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ -->
    <div id="user-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º</h3>
                <button class="modal-close" onclick="closeUserModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>–†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <select id="user-role" class="form-control">
                        <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                        <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                        <option value="super_admin">–°—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" onclick="closeUserModal()">–û—Ç–º–µ–Ω–∞</button>
                    <button type="button" class="btn btn-primary" onclick="saveUserRole()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // API Service –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ä–≤–µ—Ä–æ–º
        class ApiService {
            constructor() {
                this.baseUrl = '/api';
                this.token = localStorage.getItem('adminToken');
            }

            async request(endpoint, options = {}) {
                const url = `${this.baseUrl}${endpoint}`;
                const config = {
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${this.token}`,
                        ...options.headers
                    },
                    ...options
                };

                try {
                    const response = await fetch(url, config);
                    
                    if (response.status === 401) {
                        localStorage.removeItem('adminToken');
                        window.location.href = '/admin/login';
                        throw new Error('–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è');
                    }
                    
                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({ error: 'HTTP error' }));
                        throw new Error(errorData.error || `HTTP error! status: ${response.status}`);
                    }
                    
                    return await response.json();
                } catch (error) {
                    console.error('API request failed:', error);
                    throw error;
                }
            }

            // –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
            async login(email, password) {
                const response = await this.request('/auth/login', {
                    method: 'POST',
                    body: JSON.stringify({ email, password })
                });
                this.token = response.token;
                localStorage.setItem('adminToken', this.token);
                return response;
            }

            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            async getStats() {
                return this.request('/admin/stats');
            }

            // –ö—É—Ä—Å—ã
            async getCourses() {
                return this.request('/content/courses?limit=1000');
            }

            async createCourse(data) {
                return this.request('/admin/courses', {
                    method: 'POST',
                    body: JSON.stringify(data)
                });
            }

            async updateCourse(id, data) {
                return this.request(`/admin/courses/${id}`, {
                    method: 'PUT',
                    body: JSON.stringify(data)
                });
            }

            async deleteCourse(id) {
                return this.request(`/admin/courses/${id}`, {
                    method: 'DELETE'
                });
            }

            // –ü–æ–¥–∫–∞—Å—Ç—ã
            async getPodcasts() {
                return this.request('/content/podcasts?limit=1000');
            }

            async createPodcast(data) {
                return this.request('/admin/podcasts', {
                    method: 'POST',
                    body: JSON.stringify(data)
                });
            }

            async updatePodcast(id, data) {
                return this.request(`/admin/podcasts/${id}`, {
                    method: 'PUT',
                    body: JSON.stringify(data)
                });
            }

            async deletePodcast(id) {
                return this.request(`/admin/podcasts/${id}`, {
                    method: 'DELETE'
                });
            }

            // –í–∏–¥–µ–æ
            async getVideos() {
                return this.request('/content/videos?limit=1000');
            }

            async createVideo(data) {
                return this.request('/admin/videos', {
                    method: 'POST',
                    body: JSON.stringify(data)
                });
            }

            async updateVideo(id, data) {
                return this.request(`/admin/videos/${id}`, {
                    method: 'PUT',
                    body: JSON.stringify(data)
                });
            }

            async deleteVideo(id) {
                return this.request(`/admin/videos/${id}`, {
                    method: 'DELETE'
                });
            }

            // –ú–∞—Ç–µ—Ä–∏–∞–ª—ã
            async getMaterials() {
                return this.request('/content/materials?limit=1000');
            }

            async createMaterial(data) {
                return this.request('/admin/materials', {
                    method: 'POST',
                    body: JSON.stringify(data)
                });
            }

            async updateMaterial(id, data) {
                return this.request(`/admin/materials/${id}`, {
                    method: 'PUT',
                    body: JSON.stringify(data)
                });
            }

            async deleteMaterial(id) {
                return this.request(`/admin/materials/${id}`, {
                    method: 'DELETE'
                });
            }

            // –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏
            async getInstructors() {
                return this.request('/admin/instructors');
            }

            async createInstructor(data) {
                return this.request('/admin/instructors', {
                    method: 'POST',
                    body: JSON.stringify(data)
                });
            }

            async updateInstructor(id, data) {
                return this.request(`/admin/instructors/${id}`, {
                    method: 'PUT',
                    body: JSON.stringify(data)
                });
            }

            async deleteInstructor(id) {
                return this.request(`/admin/instructors/${id}`, {
                    method: 'DELETE'
                });
            }

            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
            async getUsers() {
                return this.request('/admin/users?limit=1000');
            }

            async updateUserRole(id, role) {
                const data = {
                    is_admin: role === 'admin' || role === 'super_admin',
                    is_super_admin: role === 'super_admin'
                };
                return this.request(`/admin/users/${id}`, {
                    method: 'PUT',
                    body: JSON.stringify(data)
                });
            }

            // –ú–µ–¥–∏–∞
            async getMedia() {
                return this.request('/admin/media');
            }

            async uploadMedia(formData) {
                return fetch(`${this.baseUrl}/upload`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${this.token}`
                    },
                    body: formData
                }).then(response => {
                    if (!response.ok) throw new Error('Upload failed');
                    return response.json();
                });
            }

            async deleteMedia(id) {
                return this.request(`/admin/media/${id}`, {
                    method: 'DELETE'
                });
            }

            // –ù–∞–≤–∏–≥–∞—Ü–∏—è
            async getNavigation() {
                return this.request('/navigation');
            }

            async createNavigationItem(data) {
                return this.request('/admin/navigation', {
                    method: 'POST',
                    body: JSON.stringify(data)
                });
            }

            async updateNavigationItem(id, data) {
                return this.request(`/admin/navigation/${id}`, {
                    method: 'PUT',
                    body: JSON.stringify(data)
                });
            }

            async deleteNavigationItem(id) {
                return this.request(`/admin/navigation/${id}`, {
                    method: 'DELETE'
                });
            }

            // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
            async getCategories(type) {
                return this.request(`/categories/${type}`);
            }

            // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
            async getSettings() {
                return this.request('/admin/settings');
            }

            async updateSettings(data) {
                return this.request('/admin/settings', {
                    method: 'PUT',
                    body: JSON.stringify(data)
                });
            }
        }

        // State Management
        class AdminState {
            constructor() {
                this.data = {
                    courses: [],
                    podcasts: [],
                    videos: [],
                    materials: [],
                    instructors: [],
                    users: [],
                    media: [],
                    navigation: [],
                    stats: {},
                    categories: {}
                };
                this.listeners = {};
            }

            setState(key, value) {
                this.data[key] = value;
                this.notify(key, value);
            }

            getState(key) {
                return this.data[key];
            }

            subscribe(key, callback) {
                if (!this.listeners[key]) {
                    this.listeners[key] = [];
                }
                this.listeners[key].push(callback);
            }

            notify(key, value) {
                if (this.listeners[key]) {
                    this.listeners[key].forEach(callback => callback(value));
                }
            }
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        const apiService = new ApiService();
        const adminState = new AdminState();
        let currentTab = 'dashboard';
        let currentEditingUser = null;
        let currentEditingItem = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
        async function initAdmin() {
            try {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                if (!apiService.token) {
                    window.location.href = '/admin/login';
                    return;
                }

                // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                await loadInitialData();
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è UI
                showTab('dashboard');
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º
                document.getElementById('content-form').addEventListener('submit', handleContentSubmit);
                document.getElementById('settings-form').addEventListener('submit', handleSettingsSubmit);
                
                console.log('–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                if (error.message.includes('401')) {
                    window.location.href = '/admin/login';
                } else {
                    showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö');
                }
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        async function loadInitialData() {
            try {
                const [stats, categories] = await Promise.all([
                    apiService.getStats(),
                    apiService.getCategories('courses')
                ]);
                
                adminState.setState('stats', stats.data);
                adminState.setState('categories', categories.data);
                updateDashboardStats(stats.data);
                populateCategorySelects(categories.data);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:', error);
                throw error;
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–∞ –¥–∞—à–±–æ—Ä–¥–µ
        function updateDashboardStats(stats) {
            document.getElementById('total-users').textContent = stats.totalUsers?.toLocaleString() || '0';
            document.getElementById('total-courses').textContent = stats.totalCourses?.toLocaleString() || '0';
            document.getElementById('total-materials').textContent = stats.totalMaterials?.toLocaleString() || '0';
            document.getElementById('active-subscriptions').textContent = stats.activeSubscriptions?.toLocaleString() || '0';
        }

        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        function populateCategorySelects(categories) {
            const categorySelects = document.querySelectorAll('#category, #courses-category');
            categorySelects.forEach(select => {
                select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>' +
                    categories.map(cat => 
                        `<option value="${cat.id}">${cat.name}</option>`
                    ).join('');
            });
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function showTab(tabName) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(`${tabName}-tab`).style.display = 'block';
            
            // –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é
            document.querySelectorAll('.admin-nav a').forEach(link => {
                link.classList.remove('active');
            });
            
            // –ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—É—é —Å—Å—ã–ª–∫—É –∏ –¥–æ–±–∞–≤–∏—Ç—å –∫–ª–∞—Å—Å
            const activeLink = Array.from(document.querySelectorAll('.admin-nav a')).find(link => 
                link.getAttribute('onclick')?.includes(`'${tabName}'`)
            );
            if (activeLink) {
                activeLink.classList.add('active');
            }
            
            currentTab = tabName;
            
            // –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏
            loadTabData(tabName);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∫–ª–∞–¥–∫–∏
        async function loadTabData(tabName) {
            const loadingElement = document.getElementById(`${tabName}-loading`);
            
            try {
                showLoading(loadingElement);
                
                switch(tabName) {
                    case 'dashboard':
                        await loadDashboardData();
                        break;
                    case 'courses':
                        await loadCourses();
                        break;
                    case 'podcasts':
                        await loadPodcasts();
                        break;
                    case 'videos':
                        await loadVideos();
                        break;
                    case 'materials':
                        await loadMaterials();
                        break;
                    case 'instructors':
                        await loadInstructors();
                        break;
                    case 'users':
                        await loadUsers();
                        break;
                    case 'media':
                        await loadMedia();
                        break;
                    case 'navigation':
                        await loadNavigation();
                        break;
                }
            } catch (error) {
                console.error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ ${tabName}:`, error);
                showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö');
            } finally {
                hideLoading(loadingElement);
            }
        }

        // ==================== –î–ê–ù–ù–´–ï –î–ê–®–ë–û–†–î–ê ====================

        async function loadDashboardData() {
            try {
                const [users, courses] = await Promise.all([
                    apiService.getUsers(),
                    apiService.getCourses()
                ]);

                // –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
                const recentUsers = users.data.slice(0, 3);
                const recentUsersHtml = recentUsers.map(user => `
                    <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--bg-secondary); border-radius: 0.375rem;">
                        <span>${user.first_name} ${user.last_name || ''}</span>
                        <span style="color: var(--text-secondary); font-size: 0.875rem;">
                            ${new Date(user.created_at).toLocaleDateString('ru-RU')}
                        </span>
                    </div>
                `).join('');

                document.getElementById('recent-users').innerHTML = recentUsersHtml;

                // –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫—É—Ä—Å—ã
                const popularCourses = courses.data.slice(0, 3);
                const popularCoursesHtml = popularCourses.map(course => `
                    <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--bg-secondary); border-radius: 0.375rem;">
                        <span>${course.title}</span>
                        <span style="color: var(--accent);">${course.students_count || 0} —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</span>
                    </div>
                `).join('');

                document.getElementById('popular-courses').innerHTML = popularCoursesHtml;

            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–∞—à–±–æ—Ä–¥–∞:', error);
            }
        }

        // ==================== –§–£–ù–ö–¶–ò–ò –ó–ê–ì–†–£–ó–ö–ò –î–ê–ù–ù–´–• ====================

        async function loadCourses() {
            try {
                const response = await apiService.getCourses();
                adminState.setState('courses', response.data);
                renderCourses(response.data);
            } catch (error) {
                throw error;
            }
        }

        function renderCourses(courses) {
            const tbody = document.getElementById('courses-tbody');
            tbody.innerHTML = courses.map(course => `
                <tr>
                    <td>${course.id}</td>
                    <td>
                        <strong>${course.title}</strong>
                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">
                            ${course.description}
                        </div>
                    </td>
                    <td>${course.category?.name || '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏'}</td>
                    <td>${formatPrice(course.price)}</td>
                    <td>${course.students_count || 0}</td>
                    <td class="${course.is_published ? 'status-active' : 'status-inactive'}">
                        ${course.is_published ? '–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω' : '–ß–µ—Ä–Ω–æ–≤–∏–∫'}
                    </td>
                    <td>
                        <div class="user-actions">
                            <button class="btn btn-outline btn-small" onclick="editCourse(${course.id})">
                                ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                            <button class="btn btn-danger btn-small" onclick="deleteContent('courses', ${course.id})">
                                üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        async function loadPodcasts() {
            try {
                const response = await apiService.getPodcasts();
                adminState.setState('podcasts', response.data);
                renderPodcasts(response.data);
            } catch (error) {
                throw error;
            }
        }

        function renderPodcasts(podcasts) {
            const tbody = document.getElementById('podcasts-tbody');
            tbody.innerHTML = podcasts.map(podcast => `
                <tr>
                    <td>${podcast.id}</td>
                    <td>${podcast.title}</td>
                    <td>${podcast.category?.name || '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏'}</td>
                    <td>${podcast.duration}</td>
                    <td>${podcast.listens || 0}</td>
                    <td>
                        <div class="user-actions">
                            <button class="btn btn-outline btn-small" onclick="editPodcast(${podcast.id})">
                                ‚úèÔ∏è
                            </button>
                            <button class="btn btn-danger btn-small" onclick="deleteContent('podcasts', ${podcast.id})">
                                üóëÔ∏è
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        async function loadVideos() {
            try {
                const response = await apiService.getVideos();
                adminState.setState('videos', response.data);
                renderVideos(response.data);
            } catch (error) {
                throw error;
            }
        }

        function renderVideos(videos) {
            const tbody = document.getElementById('videos-tbody');
            tbody.innerHTML = videos.map(video => `
                <tr>
                    <td>${video.id}</td>
                    <td>${video.title}</td>
                    <td>${video.category?.name || '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏'}</td>
                    <td>${video.duration}</td>
                    <td>${video.views || 0}</td>
                    <td>
                        <div class="user-actions">
                            <button class="btn btn-outline btn-small" onclick="editVideo(${video.id})">
                                ‚úèÔ∏è
                            </button>
                            <button class="btn btn-danger btn-small" onclick="deleteContent('videos', ${video.id})">
                                üóëÔ∏è
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        async function loadMaterials() {
            try {
                const response = await apiService.getMaterials();
                adminState.setState('materials', response.data);
                renderMaterials(response.data);
            } catch (error) {
                throw error;
            }
        }

        function renderMaterials(materials) {
            const tbody = document.getElementById('materials-tbody');
            tbody.innerHTML = materials.map(material => `
                <tr>
                    <td>${material.id}</td>
                    <td>${material.title}</td>
                    <td>${material.category?.name || '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏'}</td>
                    <td>${material.material_type}</td>
                    <td>${material.downloads || 0}</td>
                    <td>
                        <div class="user-actions">
                            <button class="btn btn-outline btn-small" onclick="editMaterial(${material.id})">
                                ‚úèÔ∏è
                            </button>
                            <button class="btn btn-danger btn-small" onclick="deleteContent('materials', ${material.id})">
                                üóëÔ∏è
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        async function loadInstructors() {
            try {
                const response = await apiService.getInstructors();
                adminState.setState('instructors', response.data);
                renderInstructors(response.data);
            } catch (error) {
                throw error;
            }
        }

        function renderInstructors(instructors) {
            const grid = document.getElementById('instructors-grid');
            grid.innerHTML = instructors.map(instructor => `
                <div class="instructor-card">
                    <div class="instructor-header">
                        <div class="instructor-avatar" style="background-image: url('${instructor.avatar_url || '/assets/instructor-default.jpg'}')"></div>
                        <div class="instructor-info">
                            <h3>${instructor.name}</h3>
                            <div class="instructor-specialization">${instructor.specialization}</div>
                        </div>
                    </div>
                    <div class="instructor-bio">
                        ${instructor.bio}
                    </div>
                    <div class="instructor-stats">
                        <div class="instructor-stat">
                            üïê ${instructor.experience_years} –ª–µ—Ç –æ–ø—ã—Ç–∞
                        </div>
                        ${instructor.email ? `
                        <div class="instructor-stat">
                            üìß ${instructor.email}
                        </div>
                        ` : ''}
                    </div>
                    <div class="user-actions">
                        <button class="btn btn-outline btn-small" onclick="editInstructor(${instructor.id})">
                            ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                        <button class="btn btn-danger btn-small" onclick="deleteInstructor(${instructor.id})">
                            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                </div>
            `).join('');
        }

        async function loadUsers() {
            try {
                const response = await apiService.getUsers();
                adminState.setState('users', response.data);
                renderUsers(response.data);
            } catch (error) {
                throw error;
            }
        }

        function renderUsers(users) {
            const tbody = document.getElementById('users-tbody');
            tbody.innerHTML = users.map(user => {
                let roleBadge = '';
                if (user.is_super_admin) {
                    roleBadge = '<span class="user-badge badge-super-admin">–°—É–ø–µ—Ä-–∞–¥–º–∏–Ω</span>';
                } else if (user.is_admin) {
                    roleBadge = '<span class="user-badge badge-admin">–ê–¥–º–∏–Ω</span>';
                } else {
                    roleBadge = '<span class="user-badge badge-user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>';
                }
                
                return `
                    <tr>
                        <td>${user.id}</td>
                        <td>${user.first_name} ${user.last_name || ''}</td>
                        <td>${user.username || '-'}</td>
                        <td>${roleBadge}</td>
                        <td>${user.subscription_end ? `–¥–æ ${new Date(user.subscription_end).toLocaleDateString('ru-RU')}` : '–ù–µ—Ç'}</td>
                        <td>
                            <div class="user-actions">
                                <button class="btn btn-outline btn-small" onclick="editUserRole(${user.id})">
                                    üëë –ò–∑–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        async function loadMedia() {
            try {
                const response = await apiService.getMedia();
                adminState.setState('media', response.data);
                renderMedia(response.data);
            } catch (error) {
                throw error;
            }
        }

        function renderMedia(media) {
            const grid = document.getElementById('media-grid');
            grid.innerHTML = media.map(file => `
                <div class="media-item">
                    <div style="font-size: 3rem; text-align: center; margin-bottom: 0.5rem;">
                        ${getFileIcon(file.mime_type)}
                    </div>
                    <div style="font-size: 0.875rem; word-break: break-all; margin-bottom: 0.5rem;">
                        ${file.original_name}
                    </div>
                    <div style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 1rem;">
                        ${formatFileSize(file.size)}
                    </div>
                    <div style="display: flex; gap: 0.5rem; justify-content: center;">
                        <button class="btn btn-outline btn-small" onclick="copyUrl('${file.url}')">
                            üìã
                        </button>
                        <button class="btn btn-danger btn-small" onclick="deleteMedia(${file.id})">
                            üóëÔ∏è
                        </button>
                    </div>
                </div>
            `).join('');
        }

        async function loadNavigation() {
            try {
                const response = await apiService.getNavigation();
                adminState.setState('navigation', response.data);
                renderNavigation(response.data);
            } catch (error) {
                throw error;
            }
        }

        function renderNavigation(navigation) {
            const grid = document.getElementById('navigation-grid');
            grid.innerHTML = navigation.map(item => `
                <div class="navigation-card">
                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                        <div style="font-size: 2rem;">${item.icon}</div>
                        <div style="flex: 1;">
                            <h4 style="margin: 0 0 0.25rem 0;">${item.title}</h4>
                            <p style="margin: 0; color: var(--text-secondary); font-size: 0.875rem;">${item.description}</p>
                            <div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                –°—Ç—Ä–∞–Ω–∏—Ü–∞: ${item.page} | –ü–æ–∑–∏—Ü–∏—è: ${item.position} | 
                                –°—Ç–∞—Ç—É—Å: ${item.is_active ? '–ê–∫—Ç–∏–≤–Ω–∞' : '–ù–µ–∞–∫—Ç–∏–≤–Ω–∞'}
                            </div>
                        </div>
                    </div>
                    ${item.image_url ? `
                    <div style="margin-bottom: 1rem;">
                        <img src="${item.image_url}" alt="${item.title}" 
                             style="width: 100%; height: 100px; object-fit: cover; border-radius: 0.5rem;"
                             onerror="this.style.display='none'">
                    </div>
                    ` : ''}
                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                        <button class="btn btn-outline btn-small" onclick="editNavigation(${item.id})">
                            ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                        <button class="btn btn-danger btn-small" onclick="deleteNavigation(${item.id})">
                            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                        </button>
                        <button class="btn btn-outline btn-small" onclick="toggleNavigationStatus(${item.id}, ${!item.is_active})">
                            ${item.is_active ? 'üëÅÔ∏è –°–∫—Ä—ã—Ç—å' : 'üëÄ –ü–æ–∫–∞–∑–∞—Ç—å'}
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // ==================== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ö–û–ù–¢–ï–ù–¢–û–ú ====================

        function showAddModal(type, editData = null) {
            const modal = document.getElementById('add-modal');
            const title = document.getElementById('modal-title');
            const form = document.getElementById('content-form');
            const contentType = document.getElementById('content-type');
            const contentId = document.getElementById('content-id');
            
            // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
            form.reset();
            
            contentType.value = type;
            contentId.value = editData ? editData.id : '';
            currentEditingItem = editData;
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞
            const action = editData ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å' : '–î–æ–±–∞–≤–∏—Ç—å';
            const typeName = getContentTypeName(type);
            title.textContent = `${action} ${typeName}`;
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è
            showRelevantFields(type);
            
            // –ó–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
            if (editData) {
                populateFormData(editData, type);
            }
            
            modal.classList.add('active');
        }

        function showRelevantFields(type) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
            document.querySelectorAll('[id$="-fields"]').forEach(el => {
                el.style.display = 'none';
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è
            switch(type) {
                case 'courses':
                    document.getElementById('course-fields').style.display = 'block';
                    break;
                case 'instructors':
                    document.getElementById('instructor-fields').style.display = 'block';
                    break;
            }
            
            // –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–¥–∏–∞ –ø–æ–ª—è
            document.getElementById('media-fields').style.display = 'block';
        }

        function populateFormData(data, type) {
            // –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è
            document.getElementById('title').value = data.title || data.name || '';
            document.getElementById('description').value = data.description || '';
            document.getElementById('category').value = data.category_id || '';
            document.getElementById('image_url').value = data.image_url || data.avatar_url || '';
            document.getElementById('is_published').checked = data.is_published || false;
            
            // –ü–æ–ª—è –∫—É—Ä—Å–∞
            if (type === 'courses') {
                document.getElementById('price').value = data.price || '';
                document.getElementById('discount').value = data.discount || '';
                document.getElementById('duration').value = data.duration || '';
                document.getElementById('modules').value = data.modules_count || '';
                document.getElementById('level').value = data.level || 'beginner';
            }
            
            // –ü–æ–ª—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
            if (type === 'instructors') {
                document.getElementById('specialization').value = data.specialization || '';
                document.getElementById('bio').value = data.bio || '';
                document.getElementById('experience_years').value = data.experience_years || '';
                document.getElementById('instructor_email').value = data.email || '';
                document.getElementById('social_links').value = data.social_links || '';
            }
        }

        function getContentTypeName(type) {
            const names = {
                'courses': '–∫—É—Ä—Å',
                'podcasts': '–ø–æ–¥–∫–∞—Å—Ç', 
                'videos': '–≤–∏–¥–µ–æ',
                'materials': '–º–∞—Ç–µ—Ä–∏–∞–ª',
                'instructors': '–ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è'
            };
            return names[type] || '–∫–æ–Ω—Ç–µ–Ω—Ç';
        }

        async function handleContentSubmit(e) {
            e.preventDefault();
            
            const type = document.getElementById('content-type').value;
            const id = document.getElementById('content-id').value;
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData);
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —á–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è
            if (data.price) data.price = parseFloat(data.price);
            if (data.discount) data.discount = parseFloat(data.discount);
            if (data.modules_count) data.modules_count = parseInt(data.modules_count);
            if (data.experience_years) data.experience_years = parseInt(data.experience_years);
            if (data.category_id) data.category_id = parseInt(data.category_id);
            
            data.is_published = document.getElementById('is_published').checked;
            
            try {
                let result;
                const action = id ? '–æ–±–Ω–æ–≤–ª–µ–Ω' : '—Å–æ–∑–¥–∞–Ω';
                
                switch(type) {
                    case 'courses':
                        if (id) {
                            result = await apiService.updateCourse(id, data);
                        } else {
                            result = await apiService.createCourse(data);
                        }
                        break;
                    case 'podcasts':
                        if (id) {
                            result = await apiService.updatePodcast(id, data);
                        } else {
                            result = await apiService.createPodcast(data);
                        }
                        break;
                    case 'videos':
                        if (id) {
                            result = await apiService.updateVideo(id, data);
                        } else {
                            result = await apiService.createVideo(data);
                        }
                        break;
                    case 'materials':
                        if (id) {
                            result = await apiService.updateMaterial(id, data);
                        } else {
                            result = await apiService.createMaterial(data);
                        }
                        break;
                    case 'instructors':
                        if (id) {
                            result = await apiService.updateInstructor(id, data);
                        } else {
                            result = await apiService.createInstructor(data);
                        }
                        break;
                }
                
                showSuccess(`–ö–æ–Ω—Ç–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ ${action}`);
                closeModal();
                
                // –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ –≤–∫–ª–∞–¥–∫–µ
                await loadTabData(currentTab);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞:', error);
                showError('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞');
            }
        }

        function closeModal() {
            document.getElementById('add-modal').classList.remove('active');
            currentEditingItem = null;
        }

        // ==================== –§–ò–õ–¨–¢–†–ê–¶–ò–Ø –î–ê–ù–ù–´–• ====================

        function filterCourses() {
            const search = document.getElementById('courses-search').value.toLowerCase();
            const category = document.getElementById('courses-category').value;
            const status = document.getElementById('courses-status').value;
            const courses = adminState.getState('courses');
            
            const filtered = courses.filter(course => {
                const matchesSearch = course.title.toLowerCase().includes(search) || 
                                    course.description.toLowerCase().includes(search);
                const matchesCategory = !category || course.category_id == category;
                const matchesStatus = !status || 
                                    (status === 'active' && course.is_published) ||
                                    (status === 'inactive' && !course.is_published);
                
                return matchesSearch && matchesCategory && matchesStatus;
            });
            
            renderCourses(filtered);
        }

        function filterUsers() {
            const search = document.getElementById('users-search').value.toLowerCase();
            const role = document.getElementById('users-role').value;
            const users = adminState.getState('users');
            
            const filtered = users.filter(user => {
                const matchesSearch = user.first_name.toLowerCase().includes(search) || 
                                    (user.last_name && user.last_name.toLowerCase().includes(search)) ||
                                    (user.username && user.username.toLowerCase().includes(search));
                const matchesRole = !role || 
                                  (role === 'user' && !user.is_admin && !user.is_super_admin) ||
                                  (role === 'admin' && user.is_admin && !user.is_super_admin) ||
                                  (role === 'super_admin' && user.is_super_admin);
                
                return matchesSearch && matchesRole;
            });
            
            renderUsers(filtered);
        }

        function filterMedia() {
            const search = document.getElementById('media-search').value.toLowerCase();
            const type = document.getElementById('media-type').value;
            const media = adminState.getState('media');
            
            const filtered = media.filter(file => {
                const matchesSearch = file.original_name.toLowerCase().includes(search);
                const matchesType = !type || 
                                  (type === 'image' && file.mime_type.startsWith('image/')) ||
                                  (type === 'video' && file.mime_type.startsWith('video/')) ||
                                  (type === 'audio' && file.mime_type.startsWith('audio/')) ||
                                  (type === 'document' && (file.mime_type.includes('pdf') || file.mime_type.includes('document')));
                
                return matchesSearch && matchesType;
            });
            
            renderMedia(filtered);
        }

        // ==================== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø–ú–ò ====================

        async function editUserRole(userId) {
            currentEditingUser = userId;
            const users = adminState.getState('users');
            const user = users.find(u => u.id === userId);
            
            if (user) {
                const roleSelect = document.getElementById('user-role');
                if (user.is_super_admin) {
                    roleSelect.value = 'super_admin';
                } else if (user.is_admin) {
                    roleSelect.value = 'admin';
                } else {
                    roleSelect.value = 'user';
                }
            }
            
            document.getElementById('user-modal').classList.add('active');
        }

        function closeUserModal() {
            document.getElementById('user-modal').classList.remove('active');
            currentEditingUser = null;
        }

        async function saveUserRole() {
            const role = document.getElementById('user-role').value;
            
            try {
                await apiService.updateUserRole(currentEditingUser, role);
                
                const roleNames = {
                    'user': '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                    'admin': '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', 
                    'super_admin': '–°—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'
                };
                
                showSuccess(`–†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è #${currentEditingUser} –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞: ${roleNames[role]}`);
                closeUserModal();
                await loadUsers();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–æ–ª–∏:', error);
                showError('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
            }
        }

        // ==================== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ù–ê–í–ò–ì–ê–¶–ò–ï–ô ====================

        function showAddNavigationModal(editItem = null) {
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>${editItem ? '‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å' : '‚ûï –î–æ–±–∞–≤–∏—Ç—å'} –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—É—é –∫–Ω–æ–ø–∫—É</h3>
                        <button class="modal-close" onclick="this.closest('.modal').remove()">√ó</button>
                    </div>
                    <div class="modal-body">
                        <form id="navigation-form">
                            <div class="form-group">
                                <label for="nav-title">–ù–∞–∑–≤–∞–Ω–∏–µ *</label>
                                <input type="text" id="nav-title" class="form-control" value="${editItem ? editItem.title : ''}" required>
                            </div>
                            <div class="form-group">
                                <label for="nav-description">–û–ø–∏—Å–∞–Ω–∏–µ *</label>
                                <textarea id="nav-description" class="form-control" rows="2" required>${editItem ? editItem.description : ''}</textarea>
                            </div>
                            <div class="form-group">
                                <label for="nav-icon">–ò–∫–æ–Ω–∫–∞ *</label>
                                <input type="text" id="nav-icon" class="form-control" value="${editItem ? editItem.icon : ''}" placeholder="üìö" required>
                            </div>
                            <div class="form-group">
                                <label for="nav-page">–°—Ç—Ä–∞–Ω–∏—Ü–∞ *</label>
                                <select id="nav-page" class="form-control" required>
                                    <option value="courses" ${editItem && editItem.page === 'courses' ? 'selected' : ''}>–ö—É—Ä—Å—ã</option>
                                    <option value="podcasts" ${editItem && editItem.page === 'podcasts' ? 'selected' : ''}>–ü–æ–¥–∫–∞—Å—Ç—ã</option>
                                    <option value="videos" ${editItem && editItem.page === 'videos' ? 'selected' : ''}>–í–∏–¥–µ–æ</option>
                                    <option value="materials" ${editItem && editItem.page === 'materials' ? 'selected' : ''}>–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</option>
                                    <option value="streams" ${editItem && editItem.page === 'streams' ? 'selected' : ''}>–≠—Ñ–∏—Ä—ã</option>
                                    <option value="events" ${editItem && editItem.page === 'events' ? 'selected' : ''}>–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</option>
                                    <option value="community" ${editItem && editItem.page === 'community' ? 'selected' : ''}>–°–æ–æ–±—â–µ—Å—Ç–≤–æ</option>
                                    <option value="favorites" ${editItem && editItem.page === 'favorites' ? 'selected' : ''}>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</option>
                                    <option value="admin" ${editItem && editItem.page === 'admin' ? 'selected' : ''}>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="nav-position">–ü–æ–∑–∏—Ü–∏—è *</label>
                                <input type="number" id="nav-position" class="form-control" value="${editItem ? editItem.position : 1}" min="1" required>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="nav-active" ${editItem ? editItem.is_active ? 'checked' : '' : 'checked'}>
                                    –ê–∫—Ç–∏–≤–Ω–∞—è
                                </label>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-outline" onclick="this.closest('.modal').remove()">–û—Ç–º–µ–Ω–∞</button>
                                <button type="submit" class="btn btn-primary">${editItem ? '–û–±–Ω–æ–≤–∏—Ç—å' : '–°–æ–∑–¥–∞—Ç—å'}</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            document.getElementById('navigation-form').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const formData = {
                    title: document.getElementById('nav-title').value,
                    description: document.getElementById('nav-description').value,
                    icon: document.getElementById('nav-icon').value,
                    page: document.getElementById('nav-page').value,
                    position: parseInt(document.getElementById('nav-position').value),
                    is_active: document.getElementById('nav-active').checked
                };
                
                try {
                    if (editItem) {
                        await apiService.updateNavigationItem(editItem.id, formData);
                    } else {
                        await apiService.createNavigationItem(formData);
                    }
                    
                    showSuccess(`–ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–∞—è –∫–Ω–æ–ø–∫–∞ ${editItem ? '–æ–±–Ω–æ–≤–ª–µ–Ω–∞' : '—Å–æ–∑–¥–∞–Ω–∞'}`);
                    modal.remove();
                    await loadNavigation();
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:', error);
                    showError('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–π –∫–Ω–æ–ø–∫–∏');
                }
            });
        }

        async function editNavigation(id) {
            const navigation = adminState.getState('navigation');
            const item = navigation.find(nav => nav.id === id);
            if (item) {
                showAddNavigationModal(item);
            }
        }

        async function deleteNavigation(id) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç?')) {
                try {
                    await apiService.deleteNavigationItem(id);
                    showSuccess('–ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç —É–¥–∞–ª–µ–Ω');
                    await loadNavigation();
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:', error);
                    showError('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞');
                }
            }
        }

        async function toggleNavigationStatus(id, newStatus) {
            try {
                const navigation = adminState.getState('navigation');
                const item = navigation.find(nav => nav.id === id);
                
                if (item) {
                    await apiService.updateNavigationItem(id, { ...item, is_active: newStatus });
                    const status = newStatus ? '–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞' : '–¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞';
                    showSuccess(`–ù–∞–≤–∏–≥–∞—Ü–∏—è ${status}`);
                    await loadNavigation();
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:', error);
                showError('–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏');
            }
        }

        // ==================== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ú–ï–î–ò–ê ====================

        function showMediaUploadModal() {
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</h3>
                        <button class="modal-close" onclick="this.closest('.modal').remove()">√ó</button>
                    </div>
                    <div class="modal-body">
                        <form id="media-upload-form" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="media-file">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª *</label>
                                <input type="file" id="media-file" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="media-description">–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                                <input type="text" id="media-description" class="form-control" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–∞">
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-outline" onclick="this.closest('.modal').remove()">–û—Ç–º–µ–Ω–∞</button>
                                <button type="submit" class="btn btn-primary">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            document.getElementById('media-upload-form').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const fileInput = document.getElementById('media-file');
                if (fileInput.files.length > 0) {
                    const formData = new FormData();
                    formData.append('file', fileInput.files[0]);
                    formData.append('description', document.getElementById('media-description').value);
                    
                    try {
                        await apiService.uploadMedia(formData);
                        showSuccess('–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω');
                        modal.remove();
                        await loadMedia();
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞:', error);
                        showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞');
                    }
                }
            });
        }

        // ==================== –§–£–ù–ö–¶–ò–ò –£–î–ê–õ–ï–ù–ò–Ø ====================

        async function deleteContent(type, id) {
            const typeNames = {
                'courses': '–∫—É—Ä—Å',
                'podcasts': '–ø–æ–¥–∫–∞—Å—Ç',
                'videos': '–≤–∏–¥–µ–æ', 
                'materials': '–º–∞—Ç–µ—Ä–∏–∞–ª'
            };
            
            if (confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç ${typeNames[type]}?`)) {
                try {
                    switch(type) {
                        case 'courses':
                            await apiService.deleteCourse(id);
                            break;
                        case 'podcasts':
                            await apiService.deletePodcast(id);
                            break;
                        case 'videos':
                            await apiService.deleteVideo(id);
                            break;
                        case 'materials':
                            await apiService.deleteMaterial(id);
                            break;
                    }
                    
                    showSuccess(`${typeNames[type]} —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω`);
                    await loadTabData(currentTab);
                } catch (error) {
                    console.error(`–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è ${type}:`, error);
                    showError(`–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è ${typeNames[type]}`);
                }
            }
        }

        async function deleteInstructor(id) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è?')) {
                try {
                    await apiService.deleteInstructor(id);
                    showSuccess('–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω');
                    await loadInstructors();
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è:', error);
                    showError('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è');
                }
            }
        }

        async function deleteMedia(id) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª?')) {
                try {
                    await apiService.deleteMedia(id);
                    showSuccess('–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω');
                    await loadMedia();
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞:', error);
                    showError('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞');
                }
            }
        }

        // ==================== –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï –ö–û–ù–¢–ï–ù–¢–ê ====================

        async function editCourse(id) {
            const courses = adminState.getState('courses');
            const course = courses.find(c => c.id === id);
            if (course) {
                showAddModal('courses', course);
            }
        }

        async function editInstructor(id) {
            const instructors = adminState.getState('instructors');
            const instructor = instructors.find(i => i.id === id);
            if (instructor) {
                showAddModal('instructors', instructor);
            }
        }

        async function editPodcast(id) {
            const podcasts = adminState.getState('podcasts');
            const podcast = podcasts.find(p => p.id === id);
            if (podcast) {
                showAddModal('podcasts', podcast);
            }
        }

        async function editVideo(id) {
            const videos = adminState.getState('videos');
            const video = videos.find(v => v.id === id);
            if (video) {
                showAddModal('videos', video);
            }
        }

        async function editMaterial(id) {
            const materials = adminState.getState('materials');
            const material = materials.find(m => m.id === id);
            if (material) {
                showAddModal('materials', material);
            }
        }

        // ==================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================

        async function handleSettingsSubmit(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData);
            
            try {
                await apiService.updateSettings(data);
                showSuccess('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫:', error);
                showError('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫');
            }
        }

        async function resetSettings() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏?')) {
                try {
                    const defaultSettings = await apiService.getSettings();
                    // –ó–¥–µ—Å—å –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    document.getElementById('settings-form').reset();
                    showSuccess('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã');
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ —Å–±—Ä–æ—Å–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫:', error);
                    showError('–û—à–∏–±–∫–∞ —Å–±—Ä–æ—Å–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫');
                }
            }
        }

        function copyUrl(url) {
            navigator.clipboard.writeText(url).then(() => {
                showSuccess('URL —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
            }).catch(() => {
                showError('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è URL');
            });
        }

        function logout() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?')) {
                localStorage.removeItem('adminToken');
                window.location.href = '/admin/login';
            }
        }

        function formatPrice(price) {
            return new Intl.NumberFormat('ru-RU').format(price) + ' ‚ÇΩ';
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function getFileIcon(mimeType) {
            if (mimeType.startsWith('image/')) return 'üñºÔ∏è';
            if (mimeType.startsWith('video/')) return 'üé¨';
            if (mimeType.startsWith('audio/')) return 'üéµ';
            if (mimeType === 'application/pdf') return 'üìÑ';
            if (mimeType.includes('document') || mimeType.includes('word')) return 'üìù';
            return 'üìé';
        }

        function showLoading(element) {
            if (element) {
                element.style.display = 'flex';
            }
        }

        function hideLoading(element) {
            if (element) {
                element.style.display = 'none';
            }
        }

        function showError(message) {
            showNotification(message, 'error');
        }

        function showSuccess(message) {
            showNotification(message, 'success');
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = type === 'error' ? 'error-message' : 'success-message';
            notification.textContent = message;
            
            const main = document.querySelector('.admin-main');
            if (main) {
                main.insertBefore(notification, main.firstChild);
                
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 5000);
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', initAdmin);
    </script>
</body>
</html>
